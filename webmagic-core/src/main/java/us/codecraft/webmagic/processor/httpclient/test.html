/*!
* @module report
* @author kael, chriscai
* @date @DATE
* Copyright (c) 2014 kael, chriscai
* Licensed under the MIT license.
*/
var BJ_REPORT=(function(global){if(global.BJ_REPORT)return global.BJ_REPORT;var _log_list=[];var _log_map={};var _config={id:0,uin:0,url:"",offline_url:"",offline_auto_url:"",ext:null,level:4,ignore:[],random:1,delay:1000,submit:null,repeat:5,offlineLog:false,offlineLogExp:5,offlineLogAuto:false};var Offline_DB={db:null,ready:function(callback){var self=this;if(!window.indexedDB||!_config.offlineLog){_config.offlineLog=false;return callback();}
if(this.db){setTimeout(function(){callback(null,self);},0);return;}
var version=1;var request=window.indexedDB.open("badjs",version);if(!request){_config.offlineLog=false;return callback();}
request.onerror=function(e){callback(e);_config.offlineLog=false;console.log("indexdb request error");return true;};request.onsuccess=function(e){self.db=e.target.result;setTimeout(function(){callback(null,self);},500);};request.onupgradeneeded=function(e){var db=e.target.result;if(!db.objectStoreNames.contains('logs')){db.createObjectStore('logs',{autoIncrement:true});}};},insertToDB:function(log){var store=this.getStore();store.add(log);},addLog:function(log){if(!this.db){return;}
this.insertToDB(log);},addLogs:function(logs){if(!this.db){return;}
for(var i=0;i<logs.length;i++){this.addLog(logs[i]);}},getLogs:function(opt,callback){if(!this.db){return;}
var store=this.getStore();var request=store.openCursor();var result=[];request.onsuccess=function(event){var cursor=event.target.result;if(cursor){if(cursor.value.time>=opt.start&&cursor.value.time<=opt.end&&cursor.value.id==opt.id&&cursor.value.uin==opt.uin){result.push(cursor.value);}
cursor["continue"]();}else{callback(null,result);}};request.onerror=function(e){callback(e);return true;};},clearDB:function(daysToMaintain){if(!this.db){return;}
var store=this.getStore();if(!daysToMaintain){store.clear();return;}
var range=(Date.now()-(daysToMaintain||2)*24*3600*1000);var request=store.openCursor();request.onsuccess=function(event){var cursor=event.target.result;if(cursor&&(cursor.value.time<range||!cursor.value.time)){store["delete"](cursor.primaryKey);cursor["continue"]();}};},getStore:function(){var transaction=this.db.transaction("logs",'readwrite');return transaction.objectStore("logs");}};var T={isOBJByType:function(o,type){return Object.prototype.toString.call(o)==="[object "+(type||"Object")+"]";},isOBJ:function(obj){var type=typeof obj;return type==="object"&&!!obj;},isEmpty:function(obj){if(obj===null)return true;if(T.isOBJByType(obj,"Number")){return false;}
return!obj;},extend:function(src,source){for(var key in source){src[key]=source[key];}
return src;},processError:function(errObj){try{if(errObj.stack){var url=errObj.stack.match("https?://[^\n]+");url=url?url[0]:"";var rowCols=url.match(":(\\d+):(\\d+)");if(!rowCols){rowCols=[0,0,0];}
var stack=T.processStackMsg(errObj);return{msg:stack,rowNum:rowCols[1],colNum:rowCols[2],target:url.replace(rowCols[0],""),_orgMsg:errObj.toString()};}else{if(errObj.name&&errObj.message&&errObj.description){return{msg:JSON.stringify(errObj)};}
return errObj;}}catch(err){return errObj;}},processStackMsg:function(error){var stack=error.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,"");var msg=error.toString();if(stack.indexOf(msg)<0){stack=msg+"@"+stack;}
return stack;},isRepeat:function(error){if(!T.isOBJ(error))return true;var msg=error.msg;var times=_log_map[msg]=(parseInt(_log_map[msg],10)||0)+1;return times>_config.repeat;}};var orgError=global.onerror;global.onerror=function(msg,url,line,col,error){var newMsg=msg;if(error&&error.stack){newMsg=T.processStackMsg(error);}
if(T.isOBJByType(newMsg,"Event")){newMsg+=newMsg.type?("--"+newMsg.type+"--"+(newMsg.target?(newMsg.target.tagName+"::"+newMsg.target.src):"")):"";}
report.push({msg:newMsg,target:url,rowNum:line,colNum:col,_orgMsg:msg});_process_log();orgError&&orgError.apply(global,arguments);};var _report_log_tostring=function(error,index){var param=[];var params=[];var stringify=[];if(T.isOBJ(error)){error.level=error.level||_config.level;for(var key in error){var value=error[key];if(!T.isEmpty(value)){if(T.isOBJ(value)){try{value=JSON.stringify(value);}catch(err){value="[BJ_REPORT detect value stringify error] "+err.toString();}}
stringify.push(key+":"+value);param.push(key+"="+encodeURIComponent(value));params.push(key+"["+index+"]="+encodeURIComponent(value));}}}
return[params.join("&"),stringify.join(","),param.join("&")];};var _offline_buffer=[];var _save2Offline=function(key,msgObj){msgObj=T.extend({id:_config.id,uin:_config.uin,time:new Date-0},msgObj);if(Offline_DB.db){Offline_DB.addLog(msgObj);return;}
if(!Offline_DB.db&&!_offline_buffer.length){Offline_DB.ready(function(err,DB){if(DB){if(_offline_buffer.length){DB.addLogs(_offline_buffer);_offline_buffer=[];}}});}
_offline_buffer.push(msgObj);};var _autoReportOffline=function(){var script=document.createElement("script");script.src=_config.offline_auto_url||_config.url.replace(/badjs$/,"offlineAuto")+"?id="+_config.id+"&uin="+_config.uin;window._badjsOfflineAuto=function(isReport){if(isReport){BJ_REPORT.reportOfflineLog();}};document.head.appendChild(script);};var submit_log_list=[];var comboTimeout=0;var _submit_log=function(){clearTimeout(comboTimeout);if(!submit_log_list.length){return;}
var url=_config._reportUrl+submit_log_list.join("&")+"&count="+submit_log_list.length+"&_t="+(+new Date);if(_config.submit){_config.submit(url);}else{var _img=new Image();_img.src=url;}
comboTimeout=0;submit_log_list=[];};var _process_log=function(isReportNow){if(!_config._reportUrl)return;var randomIgnore=Math.random()>=_config.random;while(_log_list.length){var isIgnore=false;var report_log=_log_list.shift();report_log.msg=(report_log.msg+""||"").substr(0,500);if(T.isRepeat(report_log))continue;var log_str=_report_log_tostring(report_log,submit_log_list.length);if(T.isOBJByType(_config.ignore,"Array")){for(var i=0,l=_config.ignore.length;i<l;i++){var rule=_config.ignore[i];if((T.isOBJByType(rule,"RegExp")&&rule.test(log_str[1]))||(T.isOBJByType(rule,"Function")&&rule(report_log,log_str[1]))){isIgnore=true;break;}}}
if(!isIgnore){_config.offlineLog&&_save2Offline("badjs_"+_config.id+_config.uin,report_log);if(!randomIgnore&&report_log.level!=20){submit_log_list.push(log_str[0]);_config.onReport&&(_config.onReport(_config.id,report_log));}}}
if(isReportNow){_submit_log();}else if(!comboTimeout){comboTimeout=setTimeout(_submit_log,_config.delay);}};var report=global.BJ_REPORT={push:function(msg){var data=T.isOBJ(msg)?T.processError(msg):{msg:msg};if(_config.ext&&!data.ext){data.ext=_config.ext;}
if(!data.from){data.from=location.href;}
if(data._orgMsg){var _orgMsg=data._orgMsg;delete data._orgMsg;data.level=2;var newData=T.extend({},data);newData.level=4;newData.msg=_orgMsg;_log_list.push(data);_log_list.push(newData);}else{_log_list.push(data);}
_process_log();return report;},report:function(msg,isReportNow){msg&&report.push(msg);isReportNow&&_process_log(true);return report;},info:function(msg){if(!msg){return report;}
if(T.isOBJ(msg)){msg.level=2;}else{msg={msg:msg,level:2};}
report.push(msg);return report;},debug:function(msg){if(!msg){return report;}
if(T.isOBJ(msg)){msg.level=1;}else{msg={msg:msg,level:1};}
report.push(msg);return report;},reportOfflineLog:function(){if(!window.indexedDB){BJ_REPORT.info("unsupport offlineLog");return;}
Offline_DB.ready(function(err,DB){if(!DB){return;}
var startDate=new Date-0-_config.offlineLogExp*24*3600*1000;var endDate=new Date-0;DB.getLogs({start:startDate,end:endDate,id:_config.id,uin:_config.uin},function(err,result){var iframe=document.createElement("iframe");iframe.name="badjs_offline_"+(new Date-0);iframe.frameborder=0;iframe.height=0;iframe.width=0;iframe.src="javascript:false;";iframe.onload=function(){var form=document.createElement("form");form.style.display="none";form.target=iframe.name;form.method="POST";form.action=_config.offline_url||_config.url.replace(/badjs$/,"offlineLog");form.enctype.method='multipart/form-data';var input=document.createElement("input");input.style.display="none";input.type="hidden";input.name="offline_log";input.value=JSON.stringify({logs:result,userAgent:navigator.userAgent,startDate:startDate,endDate:endDate,id:_config.id,uin:_config.uin});iframe.contentDocument.body.appendChild(form);form.appendChild(input);form.submit();setTimeout(function(){document.body.removeChild(iframe);},10000);iframe.onload=null;};document.body.appendChild(iframe);});});},offlineLog:function(msg){if(!msg){return report;}
if(T.isOBJ(msg)){msg.level=20;}else{msg={msg:msg,level:20};}
report.push(msg);return report;},init:function(config){if(T.isOBJ(config)){for(var key in config){_config[key]=config[key];}}
var id=parseInt(_config.id,10);if(id){if(/qq\.com$/gi.test(location.hostname)){if(!_config.url){_config.url="//badjs2.qq.com/badjs";}
if(!_config.uin){_config.uin=parseInt((document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10);}}
_config._reportUrl=(_config.url||"/badjs")+"?id="+id+"&uin="+_config.uin+"&";}
if(_log_list.length){_process_log();}
if(!Offline_DB._initing){Offline_DB._initing=true;Offline_DB.ready(function(err,DB){if(DB){setTimeout(function(){DB.clearDB(_config.offlineLogExp);setTimeout(function(){_config.offlineLogAuto&&_autoReportOffline();},5000);},1000);}});}
return report;},__onerror__:global.onerror};return report;}(window));if(typeof module!=="undefined"){module.exports=BJ_REPORT;};(function(global){if(!global.BJ_REPORT){console.error("please load bg-report first");return;}
var _onthrow=function(errObj){global.BJ_REPORT.push(errObj);};var tryJs={};global.BJ_REPORT.tryJs=function(throwCb){throwCb&&(_onthrow=throwCb);return tryJs;};var _merge=function(org,obj){for(var key in obj){org[key]=obj[key];}};var _isFunction=function(foo){return typeof foo==="function";};var timeoutkey;var cat=function(foo,args){return function(){try{return foo.apply(this,args||arguments);}catch(error){_onthrow(error);if(error.stack&&console&&console.error){console.error("[BJ-REPORT]",error.stack);}
if(!timeoutkey){var orgOnerror=global.onerror;global.onerror=function(){};timeoutkey=setTimeout(function(){global.onerror=orgOnerror;global.onerror=orgOnerror;timeoutkey=null;},50);}
throw error;}};};var catArgs=function(foo){return function(){var arg,args=[];for(var i=0,l=arguments.length;i<l;i++){arg=arguments[i];_isFunction(arg)&&(arg=cat(arg));args.push(arg);}
return foo.apply(this,args);};};var catTimeout=function(foo){return function(cb,timeout){if(typeof cb==="string"){try{cb=new Function(cb);}catch(err){throw err;}}
var args=[].slice.call(arguments,2);cb=cat(cb,args.length&&args);return foo(cb,timeout);};};var makeArgsTry=function(foo,self){return function(){var arg,tmp,args=[];for(var i=0,l=arguments.length;i<l;i++){arg=arguments[i];if(_isFunction(arg)){if(arg.tryWrap){arg=arg.tryWrap;}else{tmp=cat(arg);arg.tryWrap=tmp;arg=tmp;}}
args.push(arg);}
return foo.apply(self||this,args);};};var makeObjTry=function(obj){var key,value;for(key in obj){value=obj[key];if(_isFunction(value)){obj[key]=cat(value);}}
var _err=obj['error'];obj['error']=function(jqXHR,textStatus,errorThrown){BJ_REPORT.report([obj.url,jqXHR.status,'('+errorThrown+')'].join(' '));_isFunction(_err)&&_ajax.call(global.$,jqXHR,textStatus,errorThrown);};return obj;};tryJs.spyJquery=function(){var _$=global.$;if(!_$||!_$.event){return tryJs;}
var _add,_remove;if(_$.zepto){_add=_$.fn.on,_remove=_$.fn.off;_$.fn.on=makeArgsTry(_add);_$.fn.off=function(){var arg,args=[];for(var i=0,l=arguments.length;i<l;i++){arg=arguments[i];_isFunction(arg)&&arg.tryWrap&&(arg=arg.tryWrap);args.push(arg);}
return _remove.apply(this,args);};}else if(window.jQuery){_add=_$.event.add,_remove=_$.event.remove;_$.event.add=makeArgsTry(_add);_$.event.remove=function(){var arg,args=[];for(var i=0,l=arguments.length;i<l;i++){arg=arguments[i];_isFunction(arg)&&arg.tryWrap&&(arg=arg.tryWrap);args.push(arg);}
return _remove.apply(this,args);};}
var _ajax=_$.ajax;if(_ajax){_$.ajax=function(url,setting){if(!setting){setting=url;url=undefined;}
makeObjTry(setting);if(url)return _ajax.call(_$,url,setting);return _ajax.call(_$,setting);};}
return tryJs;};tryJs.spyModules=function(){var _require=global.require,_define=global.define;if(_define&&_define.amd&&_require){global.require=catArgs(_require);_merge(global.require,_require);global.define=catArgs(_define);_merge(global.define,_define);}
if(global.seajs&&_define){global.define=function(){var arg,args=[];for(var i=0,l=arguments.length;i<l;i++){arg=arguments[i];if(_isFunction(arg)){arg=cat(arg);arg.toString=(function(orgArg){return function(){return orgArg.toString();};}(arguments[i]));}
args.push(arg);}
return _define.apply(this,args);};global.seajs.use=catArgs(global.seajs.use);_merge(global.define,_define);}
return tryJs;};tryJs.spySystem=function(){global.setTimeout=catTimeout(global.setTimeout);global.setInterval=catTimeout(global.setInterval);return tryJs;};tryJs.spyCustom=function(obj){if(_isFunction(obj)){return cat(obj);}else{return makeObjTry(obj);}};tryJs.spyAll=function(){tryJs.spyJquery().spyModules().spySystem();return tryJs;};}(window));(function(global){var whiteList={"9.fanli.com":1,"f.fanli.com":1,"finder.fanli.com":1,"shzyfl.fanli.com":1,"www.shzyfl.cn":1,"cx.fanli.com":1,"gongyi.fanli.com":1,"pb.shzyfl.cn":1,"haitao.fanli.com":1,"help.fanli.com":1,"www.fanli.com":1,"huodong.fanli.com":1,"fenmi.fanli.com":1,"www.zyxx11.com":1,"fun.fanli.com":1,"m.fanli.com":1,"movie.fanli.com":1,"passport.fanli.com":1,"shop.fanli.com":1,"super.fanli.com":1,"taobao.fanli.com":1,"travel.fanli.com":1,"zhide.fanli.com":1};if(!BJ_REPORT){return;}
var host=global.location.host,reportUrl='//eagle.fanli.com/badjs';if(!whiteList[host]){return;}
BJ_REPORT.init({id:1,url:reportUrl,random:0.01,repeat:1});BJ_REPORT.tryJs().spyAll();})(window);;var CURRENT_PROTOCOL=location.protocol;(function(exports){Function.prototype.method=function(name,fn){if(typeof this.prototype[name]=="undefined")this.prototype[name]=fn;};!String.prototype.trim&&String.method("trim",function(){return this.replace(/^\s+|\s+$/g,'');});!Function.prototype.bind&&Function.method("bind",function(oThis){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}
var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){},fBound=function(){return fToBind.apply(this instanceof fNOP&&oThis?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)));};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound;});String.method("format",function(){for(var s=this,i=0;i<arguments.length;++i){s=s.replace(new RegExp("\\{"+i+"\\}","g"),arguments[i]);}
return s;});String.method("setCookie",function(value,expiryDays,domain,path,secure){if(this.length==0){return;}
var builder=[this,"=",escape(value)];if(expiryDays){var date=new Date();date.setTime(date.getTime()+(expiryDays*86400000));builder.push(";expires=");builder.push(date.toUTCString());}
if(domain){builder.push(";domain=");builder.push(domain);}
if(path){builder.push(";path=");builder.push(path);}
if(secure){builder.push(";secure");}
document.cookie=builder.join("");});String.method("getCookie",function(){if(this.length==0){return'';}
var re=new RegExp('\\b'+this+'\\s*=\\s*([^;]*)','i');var match=re.exec(document.cookie);return(match&&match.length>1?unescape(match[1]):'');});String.method("delCookie",function(domain,path){document.cookie=this+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+
(domain?"; domain="+domain:"")+
(path?"; path="+path:"");});function StringBuilder(){this.strings=new Array();}
StringBuilder.prototype.append=function(str){this.strings.push(str);return this;};StringBuilder.prototype.toString=function(){return this.strings.join("");};var GeneralRegs={alipay:/^(([a-zA-Z0-9])+([a-zA-Z0-9_\.\-])*\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4}))|(0{0,1}1[3456789]{1}[0-9]{9})$/ig,bankaccount:/^([a-zA-Z0-9]|-)+$/ig,blank:/^\s*$/,cellphone:/^0{0,1}1[3456789]{1}[0-9]{9}$/ig,email:/^([a-zA-Z0-9])+([a-zA-Z0-9_\.\-])*\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})$/ig,icard:/^(\d{18}|\d{15}|\d{17}x)$/ig,ihkcard:/^[a-z0-9]{1}\d{6,7}[a-z0-9]{1}$/ig,itwcard:/^[a-z]{1}\d{8,}$/ig,uname:/^[\u4e00-\u9fa5a-zA-Z\s]+$/ig,url:/^http(s)?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/ig,vercode:/^\d{6}$/};var FLNS={"register":function(){var a=arguments,o=null,i,j,d,rt;for(i=0;i<a.length;++i){d=a[i].split(".");rt=d[0];if(typeof window[rt]=="undefined"){window[rt]={add:function(k,v){if(!this[k]){this[k]=v;}
return this;}};}
o=window[rt];for(j=1;j<d.length;++j){o[d[j]]=o[d[j]]||{};o=o[d[j]];o.add=function(k,v){if(!this[k]){this[k]=v;}return this;};}}
return o;}};var InputValidation={"isNumber":function(intArg){return Object.prototype.toString.call(intArg)==="[object Number]";},"isEmail":function(emailStr){GeneralRegs.email.lastIndex=0;return GeneralRegs.email.test(emailStr);},"isName":function(nameStr){GeneralRegs.uname.lastIndex=0;return GeneralRegs.uname.test(nameStr);},"isUrl":function(urlStr){GeneralRegs.url.lastIndex=0;return GeneralRegs.url.test(urlStr);},"isPhone":function(phoneArg){GeneralRegs.cellphone.lastIndex=0;return GeneralRegs.cellphone.test(phoneArg);},"isICard":function(icard){return/^(?:(?:\d{18})|(?:\d{15})|(?:\d{17}x)|(?:[a-z0-9]{1}\d{6,7}[a-z0-9]{1})|(?:[a-z]{1}\d{8,}))$/ig.test(icard);}};var GeneralValidation={"isIe":function(){return /*@cc_on !@*/false;},"isIe6":function(){return!-[1,]&&!window.XMLHttpRequest;}};var GrenralEscape={"escapeRegExp":function(text){return text.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");},"escapeHTML":function(value){return value.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}};exports.StringBuilder=StringBuilder;exports.InputValidation=InputValidation;exports.GeneralValidation=GeneralValidation;exports.GeneralRegs=GeneralRegs;exports.GrenralEscape=GrenralEscape;exports.FLNS=FLNS;}(this));(function($){$.extend(FLNS.register("Fanli"),{"Class":function(parent){var klass=function(){this.init.apply(this,arguments);};if(parent){var subclass=function(){};subclass.prototype=parent.prototype;klass.prototype=new subclass();}
klass.prototype.init=function(){};klass.fn=klass.prototype;klass.fn.parent=klass;klass.extend=function(obj){var extended=obj.extended;for(var i in obj){klass[i]=obj[i];}
if(extended)extended(klass);};klass.inculde=function(obj){var included=obj.included;for(var i in obj){klass.fn[i]=obj[i];}
if(included)included(klass);};klass.proxy=function(func){var self=this;return(function(){return func.apply(self,arguments);});};klass.fn.proxy=klass.proxy;return klass;}});$.extend(FLNS.register("Fanli.Utility"),{"random":function(n){var uid=Math.random().toString(16).substr(2,n);while(uid.length<n){uid=Math.random().toString(16).substr(2,n);}
return uid;},"guid":function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);}).toUpperCase();},"staticTimeStamp":function(t){var getTime=new Date().getTime();var returnts=parseInt(getTime/300000);var currentScriptPath=$('link[rel=stylesheet]').eq(0).attr('href');if(t){returnts=parseInt(getTime/(60*1000*t));}
else if(typeof(currentScriptPath)!=="undefined"){var timeStampArr=currentScriptPath.match(/^.*[\?\&](\d+\_\d+){1}$/i);if(timeStampArr){returnts=timeStampArr[1];}}
return returnts;},"requirejs":function(jsArr,callback){var v=parseInt(new Date().getTime()/300000);if(!callback){callback=$.noop;}
$.tools=$.tools||{};var jsListConfig={'overlay':{isload:$.tools.overlay,jsUrl:"//static2.51fanli.net/common/libs/tools/overlay.min.js"},'expose':{isload:$.tools.expose,jsUrl:"//static2.51fanli.net/common/libs/tools/expose.min.js"},'light':{isload:$.light,jsUrl:"//static2.51fanli.net/static/?f=passport/js/light/createpopup.js"},'easing':{isload:$.easing["easeOutBack"],jsUrl:"//static2.51fanli.net/common/plugins/easing/jquery.easing-min.js"},'switchable':{isload:$.fn.switchable,jsUrl:"//static2.51fanli.net/common/plugins/switchable/jquery.switchable-min.js"}};var loadJs=(function(){var arr=[];$.each(jsArr,function(i,item){if(!jsListConfig[item]){return true;}
var jsObj=jsListConfig[item];if(!jsObj['isload']){var connect=/\?/.test(jsObj['jsUrl'])?'&':'?';var url=jsObj['jsUrl'];if(url.indexOf('/common/plugins/')>-1){arr.push(url);}
else{arr.push(url+connect+"v={0}".format(v));}}});return arr;})();loadJs.length>0?head&&head.load(loadJs,callback):callback();},"isLogin":"prouserid".getCookie()>0,"rootDomain":(function(){var tryExecLocation=/^.*?(\.(?:51)?fanli\.com)$/ig.exec(location.hostname);var rootDomain=".fanli.com";if(tryExecLocation){rootDomain=tryExecLocation[1];}
return rootDomain;}()),"currentDomain":document.domain});})(jQuery);(function(FPO){var $origin=$({});FPO.add("subscribe",function(){$origin.on.apply($origin,arguments);});FPO.add("unsubscribe",function(){$origin.off.apply($origin,arguments);});FPO.add("publish",function(){$origin.trigger.apply($origin,$.makeArray(arguments));});}(FLNS.register("Fanli.Pattern.Observer")));(function(){try{document.execCommand('BackgroundImageCache',false,true);}
catch(err){}})();(function($){var jsonpid=0;$.extend({"getScript":function(url,callback){return $.ajax({url:url,cache:true,dataType:"script"}).done(callback);},"getCacheJSONP":function(url,data,callback,isFixed){var linkTs=$('link[rel="stylesheet"]').attr("href").split("?")[1];var lastPrm=arguments[arguments.length-1];var isFixed=$.isFunction(lastPrm)?isFixed=true:isFixed=lastPrm;var ts=(typeof linkTs!="undefined"&&isFixed)?linkTs:"83088605"+"_"+parseInt(new Date().getTime()/300000);if($.isFunction(data)){callback=data;data=undefined;}
return $.ajax({type:"GET",url:url,cache:true,data:data,jsonpCallback:"jQuery"+ts+(++jsonpid),success:callback,dataType:"jsonp"});}});}(jQuery));(function($){if(!'FirstUrl'.getCookie()){var ref=(!!document.referrer&&document.referrer.indexOf('fanli.com')<0)?document.referrer:'//www{0}/'.format(Fanli.Utility.rootDomain);'FirstUrl'.setCookie(ref,'',Fanli.Utility.rootDomain,'/');}
if(!'LandingUrl'.getCookie()){'LandingUrl'.setCookie(window.location.href,'',Fanli.Utility.rootDomain,'/');}
$(document).on('click','a',function(){var $this=$(this);var url=$this.attr('href')||'';var re=/&v=(\d+)/gi;if(url.indexOf('fun.51fanli.com/goshop')!=-1||url.indexOf('fun.fanli.com/goshop')!=-1){if(url.indexOf('v=')==-1){url=url+'&v='+new Date().getTime();}
else{url=url.replace(re,'&v='+new Date().getTime());}
$this.attr('href',url);}});})(jQuery);function open53kf(){$.getJSON('//fun{0}/client/homepage/monitor?title=kefu&jsoncallback=?'.format(Fanli.Utility.rootDomain));var userId='prouserid'.getCookie();var params="&device=pc&entry=pc&entry_name={0}&custid={1}".format(encodeURIComponent("pc客户"),userId);window.open('https://webchat.fanli.com/WebChat/fanlionline.jsp?jid=61&sysNum=1476067342641247{0}'.format(params),'_blank');return false;}
function addFavorite(obj,msg){var url=obj.rev||window.location.href,title=obj.title||document.title;try{if(window.sidebar){window.sidebar.addPanel(title,url,'');}
else{if(window.opera&&window.print){obj.setAttribute('rel','sidebar');obj.setAttribute('href',url);obj.click();}
else{window.external.AddFavorite(url,title);}}}
catch(e){alert(msg?msg:'加入收藏失败，请使用Ctrl+D进行添加');}
return false;}
(function($){FLNS.register("taobaoRate");FLNS.taobaoRate=(function(){var rate=0.45;var rateArr=[{"st":[2007,0,1,0,0,0,0],"ed":[2013,8,27,23,59,59,999],"rate":0.45},{"st":[2013,8,28,0,0,0,0],"ed":[2013,10,1,23,59,59,999],"rate":0.36},{"st":[2013,10,2,0,0,0,0],"ed":[2099,11,31,23,59,59,999],"rate":0.45}];var nowTime=new Date();function getT(date){return new Date(date[0],date[1],date[2],date[3],date[4],date[5],date[6]);}
for(var i=0;i<rateArr.length;i++){if(nowTime>=getT(rateArr[i]["st"])&&nowTime<=getT(rateArr[i]["ed"])){rate=rateArr[i]["rate"];break;}}
return rate;}());FLNS.register("UserBenifit");UserBenifit.add("calculate",function(priceJSON,callback){var price=priceJSON.price;var originalPrice=priceJSON.originalPrice;if(!$.isNumeric(price)){callback.call({price:0},null);return;}
var userIdCookieValue="prouserid".getCookie();var experientCookieName="tb_rate";var experientCookieValue=experientCookieName.getCookie().toLowerCase();var ajaxUrl="//taobao.fanli.com/service/getUserRateType";var baseRate=FLNS.taobaoRate;var criticalPointOne=5.5;var criticalPointTwo=2;var aboveRate=0.25;var aboveRate1=0.55;var aboveRate2=0.25;var aboveRate3=0.35;var belowRate=0.8;var beginDate=new Date(2013,1,1,0,0,0,0);var endDate=new Date(2013,3,30,23,59,59,999);var newBeginDate=new Date(2013,4,1,0,0,0,0);var newEndDate=new Date(2013,5,30,23,59,59,999);var nEndDate=new Date(2013,5,1,0,0,0,0);var nnEndDate=new Date(2013,6,30,23,59,59,999);var currentDate=new Date();var callback=$.isFunction(callback)?callback:$.noop;var resultConfig={basal:price*baseRate,colorful:price>criticalPointTwo?belowRate*criticalPointTwo+aboveRate*(price-criticalPointTwo):price*belowRate,firstStrategy:theFirstStrategy(),secondStrategy:theSecondStrategy(),thirdStrategy:theThirdStrategy(),fourthStrategy:theFourthStategy(),fifthStrategy:theFifthStategy()};var experientConfig={"a":"basal","b":"colorful","c":"thirdStrategy","d":"firstStrategy","e":"secondStrategy","f":"fourthStrategy","g":"fifthStrategy","p":"basal"};var experientConfig1={"a":"basal","b":"basal","c":"basal","d":"basal","e":"basal","f":"fourthStrategy","g":"fifthStrategy","p":"basal"};var experientConfig2={"a":"basal","b":"basal","c":"basal","d":"basal","e":"basal","f":"basal","g":"basal","p":"basal"};if(currentDate>nnEndDate){callback.call({price:numberConvert(resultConfig["basal"])},null);return;}
if(currentDate>=newBeginDate&&currentDate<=nEndDate){experientConfig=experientConfig1;}
else if(currentDate>nEndDate&&currentDate<=nnEndDate){experientConfig=experientConfig2;}
if(!userIdCookieValue){unloginHandler();}
else{if(!experientCookieValue||experientCookieValue=="null"){$.ajax({url:ajaxUrl,dataType:"jsonp",jsonp:"jsoncallback",success:function(result){if(result.status=="1"){callback.call({price:numberConvert(resultConfig[experientConfig[result.data.rateType.toLowerCase()]])},null);}
else{unloginHandler();}},error:function(){unloginHandler();}});}
else{var tem=experientConfig[experientCookieValue]||'basal';callback.call({price:numberConvert(resultConfig[tem])},null);}}
function unloginHandler(){callback.call({price:numberConvert(resultConfig["basal"])},null);}
function numberConvert(i){return Number(new Number(i).toFixed(2));}
function theFirstStrategy(){return price>=criticalPointTwo?belowRate*criticalPointTwo+aboveRate1*(price-criticalPointTwo):price*belowRate;}
function theSecondStrategy(){if(price<criticalPointTwo){return price*belowRate;}
else if(price>=criticalPointTwo&&price<criticalPointOne){return belowRate*criticalPointTwo+aboveRate2*(price-criticalPointTwo)}
else{return price*baseRate;}}
function theThirdStrategy(){return price<criticalPointOne?price*baseRate:baseRate*criticalPointOne+aboveRate3*(price-criticalPointOne);}
function theFourthStategy(){if(price<criticalPointTwo){return price*belowRate;}
else if(price>=criticalPointTwo&&price<criticalPointOne){return criticalPointTwo*belowRate+aboveRate*(price-criticalPointTwo)}
else{return price*baseRate;}}
function theFifthStategy(){var maxOne=0.5;var maxTwo=1;if(price<=0.5){return Math.min(maxOne,originalPrice*0.35);}
else if(price>0.5&&price<=1){return Math.min(maxTwo,originalPrice*0.35);}
else if(price>1&&price<criticalPointTwo){return price*belowRate;}
else if(price>=criticalPointTwo&&price<criticalPointOne){return criticalPointTwo*belowRate+aboveRate*(price-criticalPointTwo);}
else{return price*baseRate;}}});})(jQuery);(function($){$("a[data-lc]").on("click",function(){var $this=$(this);var originHref=$this.attr("href");var lc=$this.attr("data-lc");if(!originHref){return;}
if(originHref.indexOf("?")>-1){$this.attr("href","{0}&lc={1}".format(originHref,lc));}else{$this.attr("href","{0}?lc={1}".format(originHref,lc));}});}(jQuery));(function(){var hostDomain=Fanli.Utility.rootDomain;var host=location.host.toLowerCase();var newLocation=location.href.replace(/51fanli\.com/i,'fanli.com');if(!host||hostDomain=='.fanli.com'||/^(fun|trace)\./.test(host)){return;}
else{window.location.href=newLocation;}})();var passportAppUrl="//passport{0}".format(Fanli.Utility.rootDomain);var redirectPrefixAfterLogin="{0}/redirect/loginsuccess".format(passportAppUrl);var redirectPrefixAfterRegister="{0}/redirect/regsuccess".format(passportAppUrl);var verifyCodeImageUrl="//fun{0}/verify.png?".format(Fanli.Utility.rootDomain);;(function(exports){var traceCrossPageCookie="__fl_trace_cpc";var traceCrossNativeAndPageCookie="__fl_trace_cnpc";var traceCrossPageCookie1="__fl_trace_cpc1";var guid=function(){var d=new Date().getTime();if(typeof performance!=='undefined'&&typeof performance.now==='function'){d+=performance.now();}
return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c==='x'?r:(r&0x3|0x8)).toString(16);});};var tid=guid().toUpperCase();var domain=(function(){var tryExecLocation=/.*(\.\w*\.\w*)$/ig.exec(location.hostname);var rootDomain=".fanli.com";if(tryExecLocation){rootDomain=tryExecLocation[1];}
return rootDomain;}());var urlReg=/^(?:(?:http(?:s)?:\/\/)?[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])|(?:\/.*))*$/ig;var CookieOperation=(function(){function _setCookie(name,value,expiryDays,domain,path,secure){var builder=[name,"=",escape(value)];if(expiryDays){var date=new Date();date.setTime(date.getTime()+(expiryDays*86400000));builder.push(";expires=");builder.push(date.toUTCString());}
if(domain){builder.push(";domain=");builder.push(domain);}
if(path){builder.push(";path=");builder.push(path);}
if(secure){builder.push(";secure");}
document.cookie=builder.join("");}
function _getCookie(name){var re=new RegExp('\\b'+name+'\\s*=\\s*([^;]*)','i');var match=re.exec(document.cookie);return(match&&match.length>1?unescape(match[1]):'');}
return{setCookie:_setCookie,getCookie:_getCookie};}());var StringOperation={format:function(s,args){for(var i=0;i<args.length;++i){s=s.replace(new RegExp("\\{"+i+"\\}","g"),args[i]);}
return s;},isUrl:function(url){if(!url){return false;}
urlReg.lastIndex=0;url=url.toString();return urlReg.test(url);}};var traceCrossNativeAndPageCookieValue=CookieOperation.getCookie(traceCrossNativeAndPageCookie);if(traceCrossNativeAndPageCookieValue){CookieOperation.setCookie(traceCrossPageCookie,traceCrossNativeAndPageCookieValue,"",domain,"/");CookieOperation.setCookie(traceCrossNativeAndPageCookie,null,-1,domain,"/");}
var ptid=CookieOperation.getCookie(traceCrossPageCookie);var utmvCookie="__utmv";var utmvCookieValue=CookieOperation.getCookie(utmvCookie);if(!utmvCookieValue){CookieOperation.setCookie(utmvCookie,guid().toUpperCase(),60,domain,"/");}
exports.UBT={isObject:function(obj){return Object.prototype.toString.call(obj)==="[object Object]";},uswitch:true,commonData:{referrer:encodeURIComponent(document.referrer),resolution_h:window.screen.height||0,resolution_v:window.screen.width||0,resolution_r:window.devicePixelRatio||1,language:navigator.language||navigator.userLanguage,url:encodeURIComponent(location.href)},behaviorData:{tab:""},mergeData:function(options){var dataObj=this.commonData;if(this.isObject(options)){for(var k in options){if(options.hasOwnProperty(k)){dataObj[k]=options[k];}}}
return this;},_sendPV:function(){var builder=[];var dataObj=this.commonData;for(var j in dataObj){if(dataObj.hasOwnProperty(j)){builder.push(StringOperation.format("{0}={1}",[j,dataObj[j]]));}}
builder.push("eventtype=pv");this._buildTrackImg(builder.join("&"));},track:function(){if(!this.uswitch){return;}
var tArr=[];var builder=[];var length=arguments.length;if(/evttype\=.+/.test(arguments[length-1])){builder.push(arguments[length-1]);length=length-1;}else{builder.push("evttype=cd");}
for(var i=0;i<length;i++){tArr.push([arguments[i]]);}
builder.push(StringOperation.format("spm={0}",[encodeURIComponent(tArr.join("."))]));this._buildTrackImg(builder.join("&"));return false;},_buildTrackImg:(function(){var imgs=[];return function(parastr){var img=new Image();var userid=CookieOperation.getCookie("prouserid");var utmo=CookieOperation.getCookie("__utmo");var utmp=CookieOperation.getCookie("__utmp");var utmt=CookieOperation.getCookie("__utmt");var utmv=CookieOperation.getCookie("__utmv");var $flMeta=$("meta[name=flpn]");var defaultParameterArr=[];var sliceNo=0;if(utmo){defaultParameterArr.push("utmo="+utmo);}
if(utmp){defaultParameterArr.push("utmp="+utmp);}
if(utmt){defaultParameterArr.push("utmt="+utmt);}
if(utmv){defaultParameterArr.push("utmv="+utmv);}
if(userid){defaultParameterArr.push("userid="+userid);}
defaultParameterArr.push("tid="+tid);if(ptid){defaultParameterArr.push("ptid="+ptid);}
defaultParameterArr.push("timestamp="+new Date().getTime());if($flMeta.length>0){defaultParameterArr.push(StringOperation.format("flpn={0}",[$flMeta.attr("content")]));}
img.onload=img.onerror=function(){img.onload=img.onerror=null;}
imgs.push(img);sliceNo=Math.round(Math.random()*9);if(location.pathname.toLowerCase().indexOf("zhide")>-1){sliceNo=0;}
img.src="https://ubt"+sliceNo+".fanli.com/index.html?"+parastr+"&"+defaultParameterArr.join("&");}})(),PlugIns:(function(){var $window=$(window);return{clickOperation:function(options){var timeId;$(document).on("click","a, button, i, span, input[type=button], input[type=submit], .J_fanli_ubt_trigger",function(ev){var $this=$(this);var $ancestor=$this.parents();var ancestorLen=$ancestor.length;var temArr=[];var traceStr="";var parameterArr=[];var $module=$this.closest(".J_ubt_module");var module=$module.length>0&&$module.data("spm");var ubtindex=$this.data("ubtindex");var halfScreen=(window.innerWidth||document.documentElement.clientWidth||document.body.offsetWidth)/2;var tagName=$this[0].tagName;var dataId=$this.data("id");var elementId=$this.attr("id");var klass=$.trim($this.attr("class")||"");var href=$this.attr("href");var text=$.trim($this.attr("data-ubttext")||$this.text()||"");var val=$this.val();var spm=$this.attr("data-spm")||"";var tryHash;var xpathArr=[];var coordinate={x:ev.pageX-halfScreen,y:ev.pageY};parameterArr.push("coordinate="+encodeURIComponent("{x:"+coordinate.x+",y:"+coordinate.y+"}"));if(StringOperation.isUrl(href)&&spm){if(href.indexOf("spm")===-1){tryHash=href.match(/.*(#.*)$/);if(tryHash){href=href.replace(/(#.*)$/ig,'');}
if(href.indexOf("?")>-1){href=href+"&spm="+spm;}else{href=href+"?spm="+spm;}
if(tryHash){href=href+tryHash[1];}}
$this.attr("href",href);}
parameterArr.push("evttype=click");if(href&&href!="javascript:void(0);"&&href!="javascript:void(0)"){parameterArr.push("href="+encodeURIComponent(href));}
if(spm){parameterArr.push("spm="+spm);}
if(module){parameterArr.push("module="+module);}
if(ubtindex){parameterArr.push("index="+ubtindex);}
parameterArr.push("depth="+Math.round(($(window).scrollTop()/$(document).height())*100));xpathArr.push(tagName.toLowerCase()+"["+$this.index()+"]");temArr.push(tagName);if(dataId){temArr.push(StringOperation.format("[data-id={0}]",[dataId]));}
if(href){temArr.push(StringOperation.format("[href={0}]",[href]));}
if(elementId){temArr.push(StringOperation.format("[id={0}]",[elementId]));}
if(klass){temArr.push(StringOperation.format("[class={0}]",[klass]));}
if(text){temArr.push(StringOperation.format("[text={0}]",[text]));}
if(val){temArr.push(StringOperation.format("[value={0}]",[val]));}
traceStr+=temArr.join("");temArr.length=0;for(var i=0;i<ancestorLen;i++){var $currentNode=$ancestor.eq(i);var currentNode=$ancestor.get(i);var id=$currentNode.attr("id");var klass=$.trim($currentNode.attr("class")||"");var tagName=currentNode.tagName;if(tagName=="HTML"||tagName=="BODY"){break;}
temArr.push(tagName);if(id){temArr.push(StringOperation.format("[id={0}]",[id]));}
if(klass){temArr.push(StringOperation.format("[class={0}]",[klass]));}
if(i>=5-1){break;}
traceStr+="_"+temArr.join("");temArr.length=0;}
for(var i=0;i<ancestorLen;i++){var $currentNode=$ancestor.eq(i);var tagName=$currentNode[0].tagName.toLowerCase();if(tagName=="html"||tagName=="body"){xpathArr.push(tagName);}else{xpathArr.push(tagName+"["+$currentNode.index()+"]");}}
parameterArr.push("evt=click_"+encodeURIComponent(traceStr));parameterArr.push("xpath="+xpathArr.reverse().join('/'));if(timeId){clearTimeout(timeId);}
CookieOperation.setCookie(traceCrossPageCookie,tid,"",domain,"/");timeId=setTimeout(function(){UBT._buildTrackImg(parameterArr.join("&"));CookieOperation.setCookie(traceCrossPageCookie1,location.href+"@@"+xpathArr.join('/'),"",domain,"/");},25);});return UBT.PlugIns;},scrollOperation:function(){var $w=$(window);var $d=$(document);var sid;var parameterArr=[];$w.on("scroll",function(ev){if(sid){clearTimeout(sid);}
sid=setTimeout(function(){var scrollTop=$w.scrollTop();var documentHeight=$d.height();parameterArr.push("dept={0}-{1}".format(scrollTop,documentHeight));parameterArr.push("spm="+Math.round((scrollTop/documentHeight)*100));parameterArr.push("evttype=scroll");if(UBT.behaviorData.tab){parameterArr.push("tab="+UBT.behaviorData.tab);}
UBT._buildTrackImg(parameterArr.join("&"));parameterArr.length=0;},800);});return UBT.PlugIns;},Exposure:{exposureArr:[],uniqueExposureObj:{},exposureElArr:[],init:function(options){var settings=$.extend(true,{$ele:$(".lazy, .J_lazy, .J_lazy_img, .J_lazyimg, .J_need_exposure").filter("[data-expo]")},options);var $ele=settings.$ele;$ele.each(function(){var $this=$(this);var dataExpo=$this.data("expo");if(UBT.PlugIns.Exposure.__isHidden($this)){return true;}
if(dataExpo&&UBT.PlugIns.Exposure.__inViewport($this)){if(!UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]){UBT.PlugIns.Exposure.exposureArr.push(dataExpo);UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]=true;}
if(!$this.prop("hasPush")){$this.prop("hasPush",true);UBT.PlugIns.Exposure.exposureElArr.push($this);}
return true;}
if($this.prop("hasBindScroll")){return true;}
$this.prop("hasBindScroll",true);function scrollHandler(){if(UBT.PlugIns.Exposure.__inViewport($this)){if(!UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]){UBT.PlugIns.Exposure.exposureArr.push(dataExpo);UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]=true;}
if(!$this.prop("hasPush")){$this.prop("hasPush",true);UBT.PlugIns.Exposure.exposureElArr.push($this);}}}
$window.on("scroll.EXPOSURE resize.EXPOSURE",scrollHandler);});$window.on("scroll.EXPOSURESEND resize.EXPOSURE",UBT.PlugIns.Exposure.__throttle(250,UBT.PlugIns.Exposure.send));UBT.PlugIns.Exposure.send();return UBT.PlugIns;},send:function(){setTimeout(function(){if(UBT.PlugIns.Exposure.exposureArr.length>0){UBT.track('common_baoguang','prouserid'.getCookie()||'ZYSCUSERID'.getCookie()||window.fl&&window.fl.app.uid||window.st&&window.st.app.uid||$("#J_haohuo_uid").val()||'[userid]',UBT.PlugIns.Exposure.exposureArr.join(","),"evttype=exposure");UBT.PlugIns.Exposure.exposureArr=[];}},200);},prepareToSend:function(dataExpo,$el){if(dataExpo&&!UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]){UBT.PlugIns.Exposure.exposureArr.push(dataExpo);UBT.PlugIns.Exposure.uniqueExposureObj[dataExpo]=true;}
if($el&&$el.length==1&&!$el.prop("hasPush")){$el.prop("hasPush",true);UBT.PlugIns.Exposure.exposureElArr.push($el);}
setTimeout(function(){UBT.PlugIns.Exposure.send();},250);},__inViewport:function($el){return!UBT.PlugIns.Exposure.__abovethetop($el)&&!UBT.PlugIns.Exposure.__belowthefold($el)&&!UBT.PlugIns.Exposure.__leftofbegin($el)&&!UBT.PlugIns.Exposure.__rightoffold($el);},__belowthefold:function($el){var fold=$window.height()+$window.scrollTop();return fold<=$el.offset().top;},__abovethetop:function($el){var fold=$window.scrollTop();return fold>=$el.offset().top+$el.height();},__rightoffold:function($el){var fold=$window.width()+(typeof Zepto==='function'?window.pageXOffset:$window.scrollLeft());return fold<=$el.offset().left;},__leftofbegin:function($el){var fold=typeof Zepto==='function'?window.pageXOffset:$window.scrollLeft();return fold>=$el.offset().left+$el.width();},__isHidden:function($el){if(typeof jQuery==="function"){return jQuery($el).is(":hidden");}
if($el.length==0){return true;}
var elem=$el[0];var width=elem.offsetWidth;var height=elem.offsetHeight;return(width===0&&height===0)||$el.css("display")==="none";},__throttle:function(delay,fn,debounce_mode){var last=0,timeId;if(typeof fn!=='function'){debounce_mode=fn;fn=delay;delay=250;}
function wrapper(){var that=this,period=(new Date()).getTime()-last,args=arguments;function exec(){last=(new Date()).getTime();fn.apply(that,args);};function clear(){timeId=undefined;};if(debounce_mode&&!timeId){exec();}
timeId&&clearTimeout(timeId);if(debounce_mode===undefined&&period>delay){exec();}else{timeId=setTimeout(debounce_mode?clear:exec,debounce_mode===undefined?delay-period:delay);}};return wrapper;}}}})(),init:function(){var traceCrossPageCookie1Value=CookieOperation.getCookie(traceCrossPageCookie1);this._sendPV();CookieOperation.setCookie(traceCrossPageCookie,tid,"",domain,"/");if(traceCrossPageCookie1Value){UBT.track(traceCrossPageCookie1Value,"evttype=autotracefromlastpage");CookieOperation.setCookie(traceCrossPageCookie1,null,-1,domain,"/");}
return this;}};}(this));(function(){if(UBT.uswitch){UBT.mergeData(typeof fgv!="undefined"&&fgv.fanlitrace?fgv.fanlitrace:{}).init();UBT.PlugIns.clickOperation().scrollOperation();UBT.PlugIns.Exposure.init();}}());
;(function(a){a.fn.placeholder=function(d){d=a.extend({type:"value",color:"#BCBCBC",zIndex:false,klass:false,offset:[0,0],repair:false,onLoad:false},d);var b=document.createElement("input");var c="placeholder" in b;if(!c){return this.each(function(){var l=a(this);var q=l.attr("placeholder");var m=d.type;if(m=="label"){var o=a('<label style="display:none;position:absolute;cursor:text;"></label>');var f=l.attr("id");var i=l.position();var g=l.width();var r=l.outerHeight();var h=l.css("padding-left");var n=l.css("z-index");var s=l.css("font-size");var e=l.css("text-indent");if(!f){f="placeholderId"+Math.random();l.attr("id",f)}if(n!="auto"){n=n+1}if(!d.klass){o.css({"z-index":n,left:i.left+d.offset[0],top:i.top+d.offset[1],width:g+"px","padding-left":h,color:d.color,"font-size":s,"line-height":r+"px","text-indent":e})}else{o.addClass(d.klass)}o.text(q).attr("for",f).insertBefore(this);function j(){o.hide()}function p(){var t=l.attr("placeholder");if(l.val()==""){o.text(t).show()}}if(d.onLoad){a(window).load(p)}else{p()}function k(){var t=l.position();o.css({left:t.left+d.offset[0],top:t.top+d.offset[1]})}l.on({"focus.placeholder":j,"blur.placeholder":p,"change.placeholder":p,"input.placeholder":p,"show.placeholder":function(){k();p()}});if(!window.screenX){l.on("keyup.placeholder",j);o[0].onpaste=function(){setTimeout(j,30)}}o[0].oncontextmenu=function(){l.focus();return false};o.on("click.placeholder",function(){l.focus()});if(l.prop("disabled")){o.off("click.placeholder")}a(window).on({"resize.placeholder":k,"load.placeholder":k})}else{if(m=="value"){if(l.val()==""){l.addClass(d.klass).css("color",d.color).val(l.attr("placeholder"))}l.focus(function(){if(l.val()==l.attr("placeholder")){l.removeClass(d.klass).css("color","").val("")}}).blur(function(){if(l.val()==""){l.addClass(d.klass).css("color",d.color).val(l.attr("placeholder"))}})}}})}}})(jQuery);
;(function(a){a.tools=a.tools||{version:"v1.2.6"},a.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(a,c){b[a]=c}};var b={"default":function(a,b){this.getPanes().hide().eq(a).show(),b.call()},fade:function(a,b){var c=this.getConf(),d=c.fadeOutSpeed,e=this.getPanes();d?e.fadeOut(d):e.hide(),e.eq(a).fadeIn(c.fadeInSpeed,b)},slide:function(a,b){var c=this.getConf();this.getPanes().slideUp(c.slideUpSpeed),this.getPanes().eq(a).slideDown(c.slideDownSpeed,b)},ajax:function(a,b){this.getPanes().eq(0).load(this.getTabs().eq(a).attr("href"),b)}},c,d;a.tools.tabs.addEffect("horizontal",function(b,e){if(!c){var f=this.getPanes().eq(b),g=this.getCurrentPane();d||(d=this.getPanes().eq(0).width()),c=!0,f.show(),g.animate({width:0},{step:function(a){f.css("width",d-a)},complete:function(){a(this).hide(),e.call(),c=!1}}),g.length||(e.call(),c=!1)}});function e(c,d,e){var f=this,g=c.add(this),h=c.find(e.tabs),i=d.jquery?d:c.children(d),j;h.length||(h=c.children()),i.length||(i=c.parent().find(d)),i.length||(i=a(d)),a.extend(this,{click:function(c,d){var i=h.eq(c);typeof c=="string"&&c.replace("#","")&&(i=h.filter("[href*="+c.replace("#","")+"]"),c=Math.max(h.index(i),0));if(e.rotate){var k=h.length-1;if(c<0)return f.click(k,d);if(c>k)return f.click(0,d)}if(!i.length){if(j>=0)return f;c=e.initialIndex,i=h.eq(c)}if(c===j)return f;d=d||a.Event(),d.type="onBeforeClick",g.trigger(d,[c]);if(!d.isDefaultPrevented()){b[e.effect].call(f,c,function(){j=c,d.type="onClick",g.trigger(d,[c])}),h.removeClass(e.current),i.addClass(e.current);return f}},getConf:function(){return e},getTabs:function(){return h},getPanes:function(){return i},getCurrentPane:function(){return i.eq(j)},getCurrentTab:function(){return h.eq(j)},getIndex:function(){return j},next:function(){return f.click(j+1)},prev:function(){return f.click(j-1)},destroy:function(){h.unbind(e.event).removeClass(e.current),i.find("a[href^=#]").unbind("click.T");return f}}),a.each("onBeforeClick,onClick".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){b&&a(f).bind(c,b);return f}}),e.history&&a.fn.history&&(a.tools.history.init(h),e.event="history"),h.each(function(b){a(this).bind(e.event,function(a){f.click(b,a);return a.preventDefault()})}),i.find("a[href^=#]").bind("click.T",function(b){f.click(a(this).attr("href"),b)}),location.hash&&e.tabs=="a"&&c.find("[href="+location.hash+"]").length?f.click(location.hash):(e.initialIndex===0||e.initialIndex>0)&&f.click(e.initialIndex)}a.fn.tabs=function(b,c){var d=this.data("tabs");d&&(d.destroy(),this.removeData("tabs")),a.isFunction(c)&&(c={onBeforeClick:c}),c=a.extend({},a.tools.tabs.conf,c),this.each(function(){d=new e(a(this),b,c),a(this).data("tabs",d)});return c.api?d:this}})(jQuery);
;(function(c){c.tools=c.tools||{version:"@VERSION"};c.tools.overlay={addEffect:function(e,f,g){b[e]=[f,g]},conf:{close:null,closeOnClick:false,closeOnEsc:false,closeSpeed:"fast",effect:"default",fixed:!c.browser.msie||c.browser.version>6,left:"center",load:false,mask:"#000",oneInstance:true,speed:"fast",target:null,top:"10%"}};var d=[],b={};c.tools.overlay.addEffect("default",function(i,h){var g=this.getConf(),e=c(window),f=this.getOverlay();if(g.fixed&&f.height()+i.top<e.height()){i.position="fixed"}else{i.top+=e.scrollTop();i.left+=e.scrollLeft();i.position="absolute"}f.css(i).fadeIn(g.speed,h)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)});function a(h,m){var o=this,f=h.add(o),n=c(window),k,j,i,e=c.tools.expose&&(m.mask||m.expose),l=Math.random().toString().slice(10);if(e){if(typeof e=="string"){e={color:e}}e.closeOnClick=e.closeOnEsc=false}var g=m.target||h.attr("rel");j=g?c(g):null||h;if(!j.length){throw"Could not find Overlay: "+g}if(h&&h.index(j)==-1){h.click(function(p){o.load(p);return p.preventDefault()})}c.extend(o,{load:function(v){var q,w;if(o.isOpened()){return o}var s=b[m.effect];if(!s){throw'Overlay: cannot find effect : "'+m.effect+'"'}if(m.oneInstance){c.each(d,function(){this.close(v)})}q=o.getOverlay();w=q.find("img[data-original]");if(w.length){w.each(function(){var x=c(this),y=x.attr("data-original");x.attr("src",y).removeAttr("data-original")})}v=v||c.Event();v.type="onBeforeLoad";f.trigger(v);if(v.isDefaultPrevented()){return o}i=true;if(e){c(j).expose(e)}var u=m.top,t=m.left,p=j.outerWidth(true),r=j.outerHeight(true);if(typeof u=="string"){u=u=="center"?Math.max((n.height()-r)/2,0):parseInt(u,10)/100*n.height()}if(t=="center"){t=Math.max((n.width()-p)/2,0)}s[0].call(o,{top:u,left:t},function(){if(i){v.type="onLoad";f.trigger(v)}});if(e&&m.closeOnClick){c.mask.getMask().one("click",o.close)}if(m.closeOnClick){c(document).on("click."+l,function(x){if(!c(x.target).parents(j).length){o.close(x)}})}if(m.closeOnEsc){c(document).on("keydown."+l,function(x){if(x.keyCode==27){o.close(x)}})}return o},close:function(p){if(!o.isOpened()){return o}p=p||c.Event();p.type="onBeforeClose";f.trigger(p);if(p.isDefaultPrevented()){return}i=false;b[m.effect][1].call(o,function(){p.type="onClose";f.trigger(p)});c(document).off("click."+l+" keydown."+l);if(e){c.mask.close()}return o},getOverlay:function(){return j},getTrigger:function(){return h},getClosers:function(){return k},isOpened:function(){return i},getConf:function(){return m}});n.on("resize",function(){var p=o.getOverlay();p.css("left",(n.width()-p.width())/2+"px")});c.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(q,p){if(c.isFunction(m[p])){c(o).on(p,m[p])}o[p]=function(r){if(r){c(o).on(p,r)}return o}});colsersSelector=m.close||".close";k=j.find(colsersSelector);if(!k.length&&!m.close){k=c('<a class="close"></a>');j.prepend(k)}j.on("click",colsersSelector,function(p){o.close(p)});if(m.load){o.load()}}c.fn.overlay=function(e){var f=this.data("overlay");if(f){return f}if(c.isFunction(e)){e={onBeforeLoad:e}}e=c.extend(true,{},c.tools.overlay.conf,e);this.each(function(){f=new a(c(this),e);d.push(f);c(this).data("overlay",f)});return e.api?f:this}})(jQuery);
;(function(a){a.tools=a.tools||{version:"v1.2.6"};var b;b=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",bgiframe:false,closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.6,startOpacity:0,color:"#000",onLoad:null,onClose:null}};function c(){if(a.browser.msie){var b=a(document).height(),c=a(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b-c<20?c:b]}return[a(document).width(),a(document).height()]}function d(b){if(b)return b.call(a.mask)}var e,f,g,h,i;a.mask={load:function(j,k){if(g)return this;typeof j=="string"&&(j={color:j}),j=j||h,h=j=a.extend(a.extend({},b.conf),j),e=a("#"+j.maskId),e.length||(e=a("<div/>").attr("id",j.maskId),a("body").append(e));var l=c();e.css({position:"absolute",top:0,left:0,width:l[0],height:l[1],display:"none",zIndex:j.zIndex});if(d(j.onBeforeLoad)===!1)return this;if(j.bgiframe&&a.fn.bgiframe)e.bgiframe();j.closeOnEsc&&a(document).bind("keydown.mask",function(b){b.keyCode==27&&a.mask.close(b)}),j.closeOnClick&&e.bind("click.mask",function(b){a.mask.close(b)}),a(window).bind("resize.mask scroll.mask",function(){a.mask.fit()}),k&&k.length&&(i=k.eq(0).css("zIndex"),a.each(k,function(){var b=a(this);/relative|absolute|fixed/i.test(b.css("position"))||b.css("position","relative")}),f=k.css({zIndex:Math.max(j.zIndex+1,i=="auto"?0:i)})),setTimeout(function(){e.css({display:"block"}),a.mask.fit(),d(j.onLoad),g="full"}, j.loadSpeed-20),g=!0;return this},close:function(){if(g){if(d(h.onBeforeClose)===!1)return this;e.fadeOut(h.closeSpeed,function(){d(h.onClose),f&&f.css({zIndex:i}),g=!1}),a(document).unbind("keydown.mask"),e.unbind("click.mask"),a(window).unbind("resize.mask")}return this},fit:function(){if(g){var a=c();e.css({width:a[0],height:a[1]})}},getMask:function(){return e},isLoaded:function(a){return a?g=="full":g},getConf:function(){return h},getExposed:function(){return f}},a.fn.mask=function(b){a.mask.load(b);return this},a.fn.expose=function(b){a.mask.load(b,this);return this}})(jQuery);
;(function(a){a.tools=a.tools||{version:"v1.2.6"},a.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:100,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,c,d){b[a]=[c,d]}};var b={toggle:[function(a){var b=this.getConf(),c=this.getTip(),d=b.opacity;d<1&&c.css({opacity:d}),c.show(),a.call()},function(a){this.getTip().hide(),a.call()}],fade:[function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeTo(c.fadeInSpeed,c.opacity,b):(this.getTip().show(),b())},function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeOut(c.fadeOutSpeed,b):(this.getTip().hide(),b())}]};function c(b,c,d){var e=d.relative?b.position().top:b.offset().top,f=d.relative?b.position().left:b.offset().left,g=d.position[0];e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop());var h=c.outerHeight()+b.outerHeight();g=="center"&&(e+=h/2),g=="bottom"&&(e+=h),g=d.position[1];var i=c.outerWidth()+b.outerWidth();g=="center"&&(f-=i/2),g=="left"&&(f-=i);return{top:e,left:f}}function d(d,e){var f=this,g=d.add(f),h,i=0,j=0,k=d.attr("title"),l=d.attr("data-tooltip"),m=b[e.effect],n,o=d.is(":input"),p=o&&d.is(":checkbox, :radio, select, :button, :submit"),q=d.attr("type"),r=e.events[q]||e.events[o?p?"widget":"input":"def"];if(!m)throw"Nonexistent effect \""+e.effect+"\"";r=r.split(/,\s*/);if(r.length!=2)throw"Tooltip: bad events configuration for "+q;d.bind(r[0],function(a){clearTimeout(i),e.predelay?j=setTimeout(function(){f.show(a)},e.predelay):f.show(a)}).bind(r[1],function(a){clearTimeout(j),e.delay?i=setTimeout(function(){f.hide(a)},e.delay):f.hide(a)}),k&&e.cancelDefault&&(d.removeAttr("title"),d.data("title",k)),a.extend(f,{show:function(b){if(!h){l?h=a(l):e.tip?h=a(e.tip).eq(0):k?h=a(e.layout).addClass(e.tipClass).appendTo(document.body).hide().append(k):(h=d.next(),h.length||(h=d.parent().next()));if(!h.length)throw"Cannot find tooltip for "+d}if(f.isShown())return f;h.stop(!0,!0);var o=c(d,h,e);e.tip&&h.html(d.data("title")),b=a.Event(),b.type="onBeforeShow",g.trigger(b,[o]);if(b.isDefaultPrevented())return f;o=c(d,h,e),h.css({position:"absolute",top:o.top,left:o.left}),n=!0,m[0].call(f,function(){b.type="onShow",n="full",g.trigger(b)});var p=e.events.tooltip.split(/,\s*/);h.data("__set")||(h.unbind(p[0]).bind(p[0],function(){clearTimeout(i),clearTimeout(j)}),p[1]&&!d.is("input:not(:checkbox, :radio), textarea")&&h.unbind(p[1]).bind(p[1],function(a){a.relatedTarget!=d[0]&&d.trigger(r[1].split(" ")[0])}),e.tip||h.data("__set",!0));return f},hide:function(c){if(!h||!f.isShown())return f;c=a.Event(),c.type="onBeforeHide",g.trigger(c);if(!c.isDefaultPrevented()){n=!1,b[e.effect][1].call(f,function(){c.type="onHide",g.trigger(c)});return f}},isShown:function(a){return a?n=="full":n},getConf:function(){return e},getTip:function(){return h},getTrigger:function(){return d}}),a.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){b&&a(f).bind(c,b);return f}})}a.fn.tooltip=function(b){var c=this.data("tooltip");if(c)return c;b=a.extend(!0,{},a.tools.tooltip.conf,b),typeof b.position=="string"&&(b.position=b.position.split(/,?\s/)),this.each(function(){c=new d(a(this),b),a(this).data("tooltip",c)});return b.api?c:this}})(jQuery);
(function(a){var b=a.tools.tooltip;b.dynamic={conf:{classNames:"top right bottom left"}};function c(b){var c=a(window),d=c.width()+c.scrollLeft(),e=c.height()+c.scrollTop();return[b.offset().top<=c.scrollTop(),d<=b.offset().left+b.width(),e<=b.offset().top+b.height(),c.scrollLeft()>=b.offset().left]}function d(a){var b=a.length;while(b--)if(a[b])return!1;return!0}a.fn.dynamic=function(e){typeof e=="number"&&(e={speed:e}),e=a.extend({},b.dynamic.conf,e);var f=a.extend(!0,{},e),g=e.classNames.split(/\s/),h;this.each(function(){var b=a(this).tooltip().onBeforeShow(function(b,e){var i=this.getTip(),j=this.getConf();h||(h=[j.position[0],j.position[1],j.offset[0],j.offset[1],a.extend({},j)]),a.extend(j,h[4]),j.position=[h[0],h[1]],j.offset=[h[2],h[3]],i.css({visibility:"hidden",position:"absolute",top:e.top,left:e.left}).show();var k=a.extend(!0,{},f),l=c(i);if(!d(l)){l[2]&&(a.extend(j,k.top),j.position[0]="top",i.addClass(g[0])),l[3]&&(a.extend(j,k.right),j.position[1]="right",i.addClass(g[1])),l[0]&&(a.extend(j,k.bottom),j.position[0]="bottom",i.addClass(g[2])),l[1]&&(a.extend(j,k.left),j.position[1]="left",i.addClass(g[3]));if(l[0]||l[2])j.offset[0]*=-1;if(l[1]||l[3])j.offset[1]*=-1}i.css({visibility:"visible"}).hide()});b.onBeforeShow(function(){var a=this.getConf(),b=this.getTip();setTimeout(function(){a.position=[h[0],h[1]],a.offset=[h[2],h[3]]},0)}),b.onHide(function(){var a=this.getTip();a.removeClass(e.classNames)}),ret=b});return e.api?ret:this}})(jQuery);
(function(a){var b=a.tools.tooltip;a.extend(b.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!a.browser.msie});var c={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};b.addEffect("slide",function(a){var b=this.getConf(),d=this.getTip(),e=b.slideFade?{opacity:b.opacity}:{},f=c[b.direction]||c.up;e[f[1]]=f[0]+"="+b.slideOffset,b.slideFade&&d.css({opacity:0}),d.show().animate(e,b.slideInSpeed,a)},function(b){var d=this.getConf(),e=d.slideOffset,f=d.slideFade?{opacity:0}:{},g=c[d.direction]||c.up,h=""+g[0];d.bounce&&(h=h=="+"?"-":"+"),f[g[1]]=h+"="+e,this.getTip().animate(f,d.slideOutSpeed,function(){a(this).hide(),b.call()})})})(jQuery);
;(function($){function rebuildMarkCode(adid){var markCodeCookie="markcode";var markCodeValue="markcode".getCookie();var execArr=/^([^\.]+)\.([^\.]+)\.([^\.]+)\.([^\.]+)$/gi.exec(markCodeValue);if(!markCodeValue||!execArr){markCodeCookie.setCookie("0.0.{0}.1".format(adid),0,Fanli.Utility.rootDomain,"/")}else{markCodeCookie.setCookie("{0}.{1}.{2}.{3}".format(execArr[1],execArr[2],adid,$.isNumeric(execArr[4])?parseInt(execArr[4])+1:1,0),0,Fanli.Utility.rootDomain,"/")}}$.fanliAdTrack={viewEvent:function(id){if(typeof id!="undefined"){UBT.track("event","view","id",id)}},clickEvent:function(id){if(typeof id!="undefined"){UBT.track("event","click","id",id);rebuildMarkCode(id)}}};$.fn.adtracker=function(settings){settings=$.extend({clickQuery:".fa-link",viewQuery:".fa-img"},settings);return this.each(function(){var $this=$(this);$this.on("click",settings.viewQuery,function(){var $this=$(this);var id=$this.closest(settings.clickQuery).data("id")||$this.data("id");$.fanliAdTrack.clickEvent(id)});$this.find(settings.viewQuery).each(function(){var $this=$(this);var id=$this.closest(settings.clickQuery).data("id")||$this.data("id");$.fanliAdTrack.viewEvent(id)})})};$.fn.adloader=function(settings){settings=$.extend({name:null,type:null,href:true,div:false,width:null,height:null,onReady:null,onLoad:null,onError:null},settings);return this.each(function(){var $this=$(this);var prefix="//event.fanli.com/proxy.php?key=";var adName=settings.name||$this.data("name");var adType=settings.type||$this.data("type");var adWidth=settings.width||$this.data("width");var adHeight=settings.height||$this.data("height");var adHref=settings.href;var adDiv=settings.div;var adUrl=prefix+adName+"&stamp="+parseInt((new Date).getTime()/3e5);function renderList(json){var html=[];var len=json.length;for(i=0;i<len;i++){var it=json[i];var href=it.link;var chkHref=adHref&&it.link!="";if(it.file!=""){if(chkHref){html.push('<a href="',href,'" data-id="',it.id,'" class="fa-link J_spm_fa_link" target="_blank" rel="nofollow">')}else if(adDiv){html.push('<div class="fa-link" data-id="',it.id,'">')}html.push('<img src="',it.file,'"');if(adWidth&&adHeight){html.push(' width="',adWidth,'" height="',adHeight,'"')}html.push(' alt="',it.name,'" class="fa-img" />')}else{if(chkHref){html.push('<a href="',href,'" data-id="',it.id,'" class="fa-text J_spm_fa_link" target="_blank" rel="nofollow">')}else if(adDiv){html.push('<div class="fa-link" data-id="',it.id,'">')}html.push(it.name)}if(chkHref){html.push("</a>")}else if(adDiv){html.push("</div>")}$.fanliAdTrack.viewEvent(it.id)}html=html.join("");$this.append(html)}function renderRandom(json){var html=[];var len=json.length;var i=Math.ceil(Math.random()*len);var it=json[i-1];var chkHref=adHref&&it.link!="";var href=it.link;if(chkHref){html.push('<a href="',href,'" data-id="',it.id,'" class="fa-link J_spm_fa_link" target="_blank" rel="nofollow">')}else if(adDiv){html.push('<div class="fa-link" data-id="',it.id,'">')}html.push('<img src="',it.file,'"');if(adWidth&&adHeight){html.push(' width="',adWidth,'" height="',adHeight,'"')}html.push(' alt="',it.name,'" class="fa-img" />');if(chkHref){html.push("</a>")}else if(adDiv){html.push("</div>")}$.fanliAdTrack.viewEvent(it.id);html=html.join("");$this.append(html)}function build(){var json=[];try{eval("json = "+adName+"Json;");if(json.length>0){if(adType=="random"){renderRandom(json)}else{renderList(json)}if(settings.onReady!=null){settings.onReady()}if(settings.onLoad!=null){$this.find("img:last").load(function(){settings.onLoad()})}}else{$this.hide();if(settings.onError!=null){settings.onError()}}}catch(e){if(window.console){console.warn("Hosts error(event.fanli.com)??")}}}if(window.head){head.js(adUrl,function(){build()})}else{$.ajax({url:adUrl,dataType:"script",cache:true,success:function(){build()}})}})};function bindTrackEvents(){$(".J-adtracker, .J_adtracker").adtracker();$(".J_spm_fa_link").on("click",function(){var id=$(this).data("id");if(id){UBT.track("event","click","id",id);rebuildMarkCode(id)}})}if(typeof wagv!="undefined"&&wagv.pageJsLoadedCallbackArr){wagv.pageJsLoadedCallbackArr.push(function(){bindTrackEvents()})}else{$(window).on("load",function(){bindTrackEvents()})}})(typeof jQuery!="undefined"?jQuery:window.Zepto);
    ;/*
    * jQuery Autocomplete plugin 1.1
    *
    * Copyright (c) 2009 Jörn Zaefferer
    *
    * Dual licensed under the MIT and GPL licenses:
    *   http://www.opensource.org/licenses/mit-license.php
    *   http://www.gnu.org/licenses/gpl.html
    *
    * Revision: $Id: jquery.autocomplete.js 15 2009-08-22 10:30:27Z joern.zaefferer $
    */
    (function(a){a.fn.extend({autocomplete:function(b,c){var d=typeof b=="string";c=a.extend({},a.Autocompleter.defaults,{url:d?b:null,data:d?null:b,delay:d?a.Autocompleter.defaults.delay:10,max:c&&!c.scroll?10:150},c);c.highlight=c.highlight||function(e){return e};c.formatMatch=c.formatMatch||c.formatItem;return this.each(function(){new a.Autocompleter(this,c)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});a.Autocompleter=function(l,g){var c={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8};var b=a(l).attr("autocomplete","off").addClass(g.inputClass);var j;var p="";var m=a.Autocompleter.Cache(g);var e=0;var u;var x={mouseDownOnSelect:false};var r=a.Autocompleter.Select(g,l,d,x);var w;a.browser.opera&&a(l.form).bind("submit.autocomplete",function(){if(w){w=false;return false}});b.bind((a.browser.opera?"keypress":"keydown")+".autocomplete",function(A){e=1;u=A.keyCode;switch(A.keyCode){case c.UP:A.preventDefault();if(r.visible()){r.prev()}else{t(0,true)}var z=r.selected();var y=z.result;b.val(y);break;case c.DOWN:A.preventDefault();if(r.visible()){r.next()}else{t(0,true)}var z=r.selected();var y=z.result;b.val(y);break;case c.PAGEUP:A.preventDefault();if(r.visible()){r.pageUp()}else{t(0,true)}break;case c.PAGEDOWN:A.preventDefault();if(r.visible()){r.pageDown()}else{t(0,true)}break;case g.multiple&&a.trim(g.multipleSeparator)==","&&c.COMMA:case c.TAB:case c.RETURN:break;case c.ESC:r.hide();break;default:clearTimeout(j);j=setTimeout(t,g.delay);break}}).focus(function(){e++}).blur(function(){e=0;if(!x.mouseDownOnSelect){s()}}).click(function(){if(e++>1&&!r.visible()){t(0,true)}}).bind("search",function(){var y=(arguments.length>1)?arguments[1]:null;function z(D,C){var A;if(C&&C.length){for(var B=0;B<C.length;B++){if(C[B].result.toLowerCase()==D.toLowerCase()){A=C[B];break}}}if(typeof y=="function"){y(A)}else{b.trigger("result",A&&[A.data,A.value])}}a.each(h(b.val()),function(A,B){f(B,z,z)})}).bind("flushCache",function(){m.flush()}).bind("setOptions",function(){a.extend(g,arguments[1]);if("data" in arguments[1]){m.populate()}}).bind("unautocomplete",function(){r.unbind();b.unbind();a(l.form).unbind(".autocomplete")});function d(){var B=r.selected();if(!B){return false}var y=B.result;p=y;if(g.multiple){var E=h(b.val());if(E.length>1){var A=g.multipleSeparator.length;var D=a(l).selection().start;var C,z=0;a.each(E,function(F,G){z+=G.length;if(D<=z){C=F;return false}z+=A});E[C]=y;y=E.join(g.multipleSeparator)}y+=g.multipleSeparator}b.val(y);v();b.trigger("result",[B.data,B.value]);return true}function t(A,z){if(u==c.DEL){r.hide();return}var y=b.val();if(!z&&y==p){return}p=y;y=i(y);if(y.length>=g.minChars){b.addClass(g.loadingClass);if(!g.matchCase){y=y.toLowerCase()}f(y,k,v)}else{n();r.hide()}}function h(y){if(!y){return[""]}if(!g.multiple){return[a.trim(y)]}return a.map(y.split(g.multipleSeparator),function(z){return a.trim(y).length?a.trim(z):null})}function i(y){if(!g.multiple){return y}var A=h(y);if(A.length==1){return A[0]}var z=a(l).selection().start;if(z==y.length){A=h(y)}else{A=h(y.replace(y.substring(z),""))}return A[A.length-1]}function q(y,z){if(g.autoFill&&(i(b.val()).toLowerCase()==y.toLowerCase())&&u!=c.BACKSPACE){b.val(b.val()+z.substring(i(p).length));a(l).selection(p.length,p.length+z.length)}}function s(){clearTimeout(j);j=setTimeout(v,200)}function v(){var y=r.visible();r.hide();clearTimeout(j);n();if(g.mustMatch){b.search(function(z){if(!z){if(g.multiple){var A=h(b.val()).slice(0,-1);b.val(A.join(g.multipleSeparator)+(A.length?g.multipleSeparator:""))}else{b.val("");b.trigger("result",null)}}})}}function k(z,y){if(y&&y.length&&e){n();r.display(y,z);q(z,y[0].value);r.show()}else{v()}}function f(z,B,y){if(!g.matchCase){z=z.toLowerCase()}var A=m.load(z);if(A&&A.length){B(z,A)}else{if((typeof g.url=="string")&&(g.url.length>0)){var C={timestamp:+new Date()};a.each(g.extraParams,function(D,E){C[D]=typeof E=="function"?E():E});a.ajax({mode:"abort",port:"autocomplete"+l.name,dataType:g.dataType,url:g.url,data:a.extend({q:i(z),limit:g.max},C),success:function(E){var D=g.parse&&g.parse(E)||o(E);m.add(z,D);B(z,D)}})}else{r.emptyList();y(z)}}}function o(B){var y=[];var A=B.split("\n");for(var z=0;z<A.length;z++){var C=a.trim(A[z]);if(C){C=C.split("|");y[y.length]={data:C,value:C[0],result:g.formatResult&&g.formatResult(C,C[0])||C[0]}}}return y}function n(){b.removeClass(g.loadingClass)}};a.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:false,matchSubset:true,matchContains:false,cacheLength:10,max:100,mustMatch:false,extraParams:{},selectFirst:true,formatItem:function(b){return b[0]},formatMatch:null,autoFill:false,width:0,multiple:false,multipleSeparator:", ",highlight:function(c,b){return c.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:true,scrollHeight:180};a.Autocompleter.Cache=function(c){var f={};var d=0;function h(l,k){if(!c.matchCase){l=l.toLowerCase()}var j=l.indexOf(k);if(c.matchContains=="word"){j=l.toLowerCase().search("\\b"+k.toLowerCase())}if(j==-1){return false}return j==0||c.matchContains}function g(j,i){if(d>c.cacheLength){b()}if(!f[j]){d++}f[j]=i}function e(){if(!c.data){return false}var k={},j=0;if(!c.url){c.cacheLength=1}k[""]=[];for(var m=0,l=c.data.length;m<l;m++){var p=c.data[m];p=(typeof p=="string")?[p]:p;var o=c.formatMatch(p,m+1,c.data.length);if(o===false){continue}var n=o.charAt(0).toLowerCase();if(!k[n]){k[n]=[]}var q={value:o,data:p,result:c.formatResult&&c.formatResult(p)||o};k[n].push(q);if(j++<c.max){k[""].push(q)}}a.each(k,function(r,s){c.cacheLength++;g(r,s)})}setTimeout(e,25);function b(){f={};d=0}return{flush:b,add:g,populate:e,load:function(n){if(!c.cacheLength||!d){return null}if(!c.url&&c.matchContains){var m=[];for(var j in f){if(j.length>0){var o=f[j];a.each(o,function(p,k){if(h(k.value,n)){m.push(k)}})}}return m}else{if(f[n]){return f[n]}else{if(c.matchSubset){for(var l=n.length-1;l>=c.minChars;l--){var o=f[n.substr(0,l)];if(o){var m=[];a.each(o,function(p,k){if(h(k.value,n)){m[m.length]=k}});return m}}}}}return null}}};a.Autocompleter.Select=function(e,j,l,p){var i={ACTIVE:"ac_over"};var k,f=-1,r,m="",s=true,c,o;function n(){if(!s){return}c=a("<div/>").hide().addClass(e.resultsClass).css("position","absolute").appendTo(document.body);o=a("<ul/>").appendTo(c).mouseover(function(t){if(q(t).nodeName&&q(t).nodeName.toUpperCase()=="LI"){f=a("li",o).removeClass(i.ACTIVE).index(q(t));a(q(t)).addClass(i.ACTIVE)}}).click(function(t){a(q(t)).addClass(i.ACTIVE);l();j.focus();return false}).mousedown(function(){p.mouseDownOnSelect=true}).mouseup(function(){p.mouseDownOnSelect=false});if(e.width>0){c.css("width",e.width)}s=false}function q(u){var t=u.target;while(t&&t.tagName!="LI"){t=t.parentNode}if(!t){return[]}return t}function h(t){k.slice(f,f+1).removeClass(i.ACTIVE);g(t);var v=k.slice(f,f+1).addClass(i.ACTIVE);if(e.scroll){var u=0;k.slice(0,f).each(function(){u+=this.offsetHeight});if((u+v[0].offsetHeight-o.scrollTop())>o[0].clientHeight){o.scrollTop(u+v[0].offsetHeight-o.innerHeight())}else{if(u<o.scrollTop()){o.scrollTop(u)}}}}function g(t){f+=t;if(f<0){f=k.size()-1}else{if(f>=k.size()){f=0}}}function b(t){return e.max&&e.max<t?e.max:t}function d(){o.empty();var u=b(r.length);for(var v=0;v<u;v++){if(!r[v]){continue}var w=e.formatItem(r[v].data,v+1,u,r[v].value,m);if(w===false){continue}var t=a("<li/>").html(e.highlight(w,m)).addClass(v%2==0?"ac_even":"ac_odd").appendTo(o)[0];a.data(t,"ac_data",r[v])}k=o.find("li");if(e.selectFirst){k.slice(0,1).addClass(i.ACTIVE);f=0}if(a.fn.bgiframe){o.bgiframe()}}return{display:function(u,t){n();r=u;m=t;d()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){if(f!=0&&f-8<0){h(-f)}else{h(-8)}},pageDown:function(){if(f!=k.size()-1&&f+8>k.size()){h(k.size()-1-f)}else{h(8)}},hide:function(){c&&c.hide();k&&k.removeClass(i.ACTIVE);f=-1},visible:function(){return c&&c.is(":visible")},current:function(){return this.visible()&&(k.filter("."+i.ACTIVE)[0]||e.selectFirst&&k[0])},show:function(){var v=a(j).offset();c.css({width:typeof e.width=="string"||e.width>0?e.width:a(j).width(),top:v.top+j.offsetHeight,left:v.left}).show();if(e.scroll){o.scrollTop(0);o.css({maxHeight:e.scrollHeight,overflow:"visible"});if(a.browser.msie&&typeof document.body.style.maxHeight==="undefined"){var t=0;k.each(function(){t+=this.offsetHeight});var u=t>e.scrollHeight;o.css("height",u?e.scrollHeight:t);if(!u){k.width(o.width()-parseInt(k.css("padding-left"))-parseInt(k.css("padding-right")))}}}},selected:function(){var t=k&&k.filter("."+i.ACTIVE);return t&&t.length&&a.data(t[0],"ac_data")},emptyList:function(){o&&o.empty()},unbind:function(){c&&c.remove()}}};a.fn.selection=function(i,b){if(i!==undefined){return this.each(function(){if(this.createTextRange){var j=this.createTextRange();if(b===undefined||i==b){j.move("character",i);j.select()}else{j.collapse(true);j.moveStart("character",i);j.moveEnd("character",b);j.select()}}else{if(this.setSelectionRange){this.setSelectionRange(i,b)}else{if(this.selectionStart){this.selectionStart=i;this.selectionEnd=b}}}})}var g=this[0];if(g.createTextRange){var c=document.selection.createRange(),h=g.value,f="<->",d=c.text.length;c.text=f;var e=g.value.indexOf(f);g.value=h;this.selection(e,e+d);return{start:e,end:e+d}}else{if(g.selectionStart!==undefined){return{start:g.selectionStart,end:g.selectionEnd}}}}})(jQuery);
    ;(function(a){a.fn.sidebar=function(b){b=a.extend({min:1,fadeSpeed:200,position:"bottom",anchorOffset:0,relative:false,relativeWidth:960,backToTop:false,backContainer:"#backToTop",smooth:".smooth",overlay:false,onShow:null},b);return this.each(function(){var i=a(this),o=a.browser,c=a(window),d=a(document),g=a("body, html"),n=b.fadeSpeed,j=i.css(b.position),h=/^\d+%$/.test(j)?parseInt(parseInt(j,10)/100*c.height()):parseInt(j),m=(c.height()+b.min>=d.height())&&!b.backToTop;var e=function(){if(!!window.ActiveXObject&&!window.XMLHttpRequest){i.css({position:"absolute"});if(b.position=="bottom"){i.css({top:c.scrollTop()+c.height()-i.height()-h})}if(b.position=="top"){i.css({top:c.scrollTop()+h})}}if(c.scrollTop()>=b.min||m){i.fadeIn(n);if(typeof(b.onShow)==="function"){b.onShow()}}else{i.fadeOut(n)}};if(b.min==0||m){e()}c.on("scroll.sidebar",function(){e()});if(b.relative){var l=b.relativeWidth,f=i.width(),k=(c.width()+l)/2;i.css("left",k);c.on("resize.sidebar scroll.sidebar",function(){var p=c.width();if(b.overlay){k=(p-f*2>l)?((p+l)/2):(p-f)}else{k=(p+l)/2}i.css("left",k)})}if(b.backToTop){a(b.backContainer).click(function(){g.animate({scrollTop:0},100);return false})}i.find(b.smooth).click(function(p){var q=a(a(this).attr("href"));if(a(this).attr("href").charAt(0)=="#"&&q.length>0){p.preventDefault();g.animate({scrollTop:q.offset().top-b.anchorOffset},100)}})})}})(jQuery);
    ;(function(c,b,a,e){var d=c(b);c.fn.lazyload=function(f){var h=this;var i;var g={threshold:200,failure_limit:10,event:"scroll",effect:"fadeIn",container:b,data_attribute:"original",skip_invisible:true,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};function j(){var k=0;h.each(function(){var l=c(this);if(g.skip_invisible&&!l.is(":visible")){return}if(c.abovethetop(this,g)||c.leftofbegin(this,g)){}else{if(!c.belowthefold(this,g)&&!c.rightoffold(this,g)){l.trigger("appear");k=0}else{if(++k>g.failure_limit){return false}}}})}if(f){if(e!==f.failurelimit){f.failure_limit=f.failurelimit;delete f.failurelimit}if(e!==f.effectspeed){f.effect_speed=f.effectspeed;delete f.effectspeed}c.extend(g,f)}i=(g.container===e||g.container===b)?d:c(g.container);if(0===g.event.indexOf("scroll")){i.bind(g.event,function(){return j()})}this.each(function(){var k=this;var l=c(k);k.loaded=false;if(l.attr("src")===e||l.attr("src")===false){if(l.is("img")){l.attr("src",g.placeholder)}}l.one("appear",function(){if(!this.loaded){if(g.appear){var m=h.length;g.appear.call(k,m,g)}c("<img />").bind("load",function(){var o=l.attr("data-"+g.data_attribute);if(!o){return}l.hide();if(l.is("img")){l.attr("src",o)}else{l.css("background-image","url('"+o+"')")}l[g.effect](g.effect_speed);k.loaded=true;if(l.attr("data-spm")){UBT&&UBT.track(l.attr("data-spm"))}var n=c.grep(h,function(q){return !q.loaded});h=c(n);if(g.load){var p=h.length;g.load.call(k,p,g)}}).attr("src",l.attr("data-"+g.data_attribute))}});if(0!==g.event.indexOf("scroll")){l.bind(g.event,function(){if(!k.loaded){l.trigger("appear")}})}});d.bind("resize",function(){j()});if((/(?:iphone|ipod|ipad).*os 5/gi).test(navigator.appVersion)){d.bind("pageshow",function(k){if(k.originalEvent&&k.originalEvent.persisted){h.each(function(){c(this).trigger("appear")})}})}c(a).ready(function(){j()});return this};c.belowthefold=function(g,h){var f;if(h.container===e||h.container===b){f=(b.innerHeight?b.innerHeight:d.height())+d.scrollTop()}else{f=c(h.container).offset().top+c(h.container).height()}return f<=c(g).offset().top-h.threshold};c.rightoffold=function(g,h){var f;if(h.container===e||h.container===b){f=d.width()+d.scrollLeft()}else{f=c(h.container).offset().left+c(h.container).width()}return f<=c(g).offset().left-h.threshold};c.abovethetop=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollTop()}else{f=c(h.container).offset().top}return f>=c(g).offset().top+h.threshold+c(g).height()};c.leftofbegin=function(g,h){var f;if(h.container===e||h.container===b){f=d.scrollLeft()}else{f=c(h.container).offset().left}return f>=c(g).offset().left+h.threshold+c(g).width()};c.inviewport=function(f,g){return !c.rightoffold(f,g)&&!c.leftofbegin(f,g)&&!c.belowthefold(f,g)&&!c.abovethetop(f,g)};c.extend(c.expr[":"],{"below-the-fold":function(f){return c.belowthefold(f,{threshold:0})},"above-the-top":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-screen":function(f){return c.rightoffold(f,{threshold:0})},"left-of-screen":function(f){return !c.rightoffold(f,{threshold:0})},"in-viewport":function(f){return c.inviewport(f,{threshold:0})},"above-the-fold":function(f){return !c.belowthefold(f,{threshold:0})},"right-of-fold":function(f){return c.rightoffold(f,{threshold:0})},"left-of-fold":function(f){return !c.rightoffold(f,{threshold:0})}})})(jQuery,window,document);
    ;/* http://keith-wood.name/countdown.html
    Countdown for jQuery v1.6.3.
    Written by Keith Wood (kbwood{at}iinet.com.au) January 2008.
    Available under the MIT (https://github.com/jquery/jquery/blob/master/MIT-LICENSE.txt) license.
    Please attribute the author if you use it. */
    (function($){function Countdown(){this.regional=[];this.regional['']={labels:['Years','Months','Weeks','Days','Hours','Minutes','Seconds'],labels1:['Year','Month','Week','Day','Hour','Minute','Second'],compactLabels:['y','m','w','d'],whichLabels:null,digits:['0','1','2','3','4','5','6','7','8','9'],timeSeparator:':',isRTL:false};this._defaults={until:null,since:null,timezone:null,serverSync:null,format:'dHMS',layout:'',compact:false,significant:0,description:'',expiryUrl:'',expiryText:'',alwaysExpire:false,onExpiry:null,onTick:null,tickInterval:1};$.extend(this._defaults,this.regional['']);this._serverSyncs=[];var c=(typeof Date.now=='function'?Date.now:function(){return new Date().getTime()});var d=(window.performance&&typeof window.performance.now=='function');function timerCallBack(a){var b=(a<1e12?(d?(performance.now()+performance.timing.navigationStart):c()):a||c());if(b-f>=1000){x._updateTargets();f=b}e(timerCallBack)}var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null;var f=0;if(!e||$.noRequestAnimationFrame){$.noRequestAnimationFrame=null;setInterval(function(){x._updateTargets()},980)}else{f=window.animationStartTime||window.webkitAnimationStartTime||window.mozAnimationStartTime||window.oAnimationStartTime||window.msAnimationStartTime||c();e(timerCallBack)}}var Y=0;var O=1;var W=2;var D=3;var H=4;var M=5;var S=6;$.extend(Countdown.prototype,{markerClassName:'hasCountdown',propertyName:'countdown',_rtlClass:'countdown_rtl',_sectionClass:'countdown_section',_amountClass:'countdown_amount',_rowClass:'countdown_row',_holdingClass:'countdown_holding',_showClass:'countdown_show',_descrClass:'countdown_descr',_timerTargets:[],setDefaults:function(a){this._resetExtraLabels(this._defaults,a);$.extend(this._defaults,a||{})},UTCDate:function(a,b,c,e,f,g,h,i){if(typeof b=='object'&&b.constructor==Date){i=b.getMilliseconds();h=b.getSeconds();g=b.getMinutes();f=b.getHours();e=b.getDate();c=b.getMonth();b=b.getFullYear()}var d=new Date();d.setUTCFullYear(b);d.setUTCDate(1);d.setUTCMonth(c||0);d.setUTCDate(e||1);d.setUTCHours(f||0);d.setUTCMinutes((g||0)-(Math.abs(a)<30?a*60:a));d.setUTCSeconds(h||0);d.setUTCMilliseconds(i||0);return d},periodsToSeconds:function(a){return a[0]*31557600+a[1]*2629800+a[2]*604800+a[3]*86400+a[4]*3600+a[5]*60+a[6]},_attachPlugin:function(a,b){a=$(a);if(a.hasClass(this.markerClassName)){return}var c={options:$.extend({},this._defaults),_periods:[0,0,0,0,0,0,0]};a.addClass(this.markerClassName).data(this.propertyName,c);this._optionPlugin(a,b)},_addTarget:function(a){if(!this._hasTarget(a)){this._timerTargets.push(a)}},_hasTarget:function(a){return($.inArray(a,this._timerTargets)>-1)},_removeTarget:function(b){this._timerTargets=$.map(this._timerTargets,function(a){return(a==b?null:a)})},_updateTargets:function(){for(var i=this._timerTargets.length-1;i>=0;i--){this._updateCountdown(this._timerTargets[i])}},_optionPlugin:function(a,b,c){a=$(a);var d=a.data(this.propertyName);if(!b||(typeof b=='string'&&c==null)){var e=b;b=(d||{}).options;return(b&&e?b[e]:b)}if(!a.hasClass(this.markerClassName)){return}b=b||{};if(typeof b=='string'){var e=b;b={};b[e]=c}if(b.layout){b.layout=b.layout.replace(/&lt;/g,'<').replace(/&gt;/g,'>')}this._resetExtraLabels(d.options,b);var f=(d.options.timezone!=b.timezone);$.extend(d.options,b);this._adjustSettings(a,d,b.until!=null||b.since!=null||f);var g=new Date();if((d._since&&d._since<g)||(d._until&&d._until>g)){this._addTarget(a[0])}this._updateCountdown(a,d)},_updateCountdown:function(a,b){var c=$(a);b=b||c.data(this.propertyName);if(!b){return}c.html(this._generateHTML(b)).toggleClass(this._rtlClass,b.options.isRTL);if($.isFunction(b.options.onTick)){var d=b._hold!='lap'?b._periods:this._calculatePeriods(b,b._show,b.options.significant,new Date());if(b.options.tickInterval==1||this.periodsToSeconds(d)%b.options.tickInterval==0){b.options.onTick.apply(a,[d])}}var e=b._hold!='pause'&&(b._since?b._now.getTime()<b._since.getTime():b._now.getTime()>=b._until.getTime());if(e&&!b._expiring){b._expiring=true;if(this._hasTarget(a)||b.options.alwaysExpire){this._removeTarget(a);if($.isFunction(b.options.onExpiry)){b.options.onExpiry.apply(a,[])}if(b.options.expiryText){var f=b.options.layout;b.options.layout=b.options.expiryText;this._updateCountdown(a,b);b.options.layout=f}if(b.options.expiryUrl){window.location=b.options.expiryUrl}}b._expiring=false}else if(b._hold=='pause'){this._removeTarget(a)}c.data(this.propertyName,b)},_resetExtraLabels:function(a,b){var c=false;for(var n in b){if(n!='whichLabels'&&n.match(/[Ll]abels/)){c=true;break}}if(c){for(var n in a){if(n.match(/[Ll]abels[02-9]|compactLabels1/)){a[n]=null}}}},_adjustSettings:function(a,b,c){var d;var e=0;var f=null;for(var i=0;i<this._serverSyncs.length;i++){if(this._serverSyncs[i][0]==b.options.serverSync){f=this._serverSyncs[i][1];break}}if(f!=null){e=(b.options.serverSync?f:0);d=new Date()}else{var g=($.isFunction(b.options.serverSync)?b.options.serverSync.apply(a,[]):null);d=new Date();e=(g?d.getTime()-g.getTime():0);this._serverSyncs.push([b.options.serverSync,e])}var h=b.options.timezone;h=(h==null?-d.getTimezoneOffset():h);if(c||(!c&&b._until==null&&b._since==null)){b._since=b.options.since;if(b._since!=null){b._since=this.UTCDate(h,this._determineTime(b._since,null));if(b._since&&e){b._since.setMilliseconds(b._since.getMilliseconds()+e)}}b._until=this.UTCDate(h,this._determineTime(b.options.until,d));if(e){b._until.setMilliseconds(b._until.getMilliseconds()+e)}}b._show=this._determineShow(b)},_destroyPlugin:function(a){a=$(a);if(!a.hasClass(this.markerClassName)){return}this._removeTarget(a[0]);a.removeClass(this.markerClassName).empty().removeData(this.propertyName)},_pausePlugin:function(a){this._hold(a,'pause')},_lapPlugin:function(a){this._hold(a,'lap')},_resumePlugin:function(a){this._hold(a,null)},_hold:function(a,b){var c=$.data(a,this.propertyName);if(c){if(c._hold=='pause'&&!b){c._periods=c._savePeriods;var d=(c._since?'-':'+');c[c._since?'_since':'_until']=this._determineTime(d+c._periods[0]+'y'+d+c._periods[1]+'o'+d+c._periods[2]+'w'+d+c._periods[3]+'d'+d+c._periods[4]+'h'+d+c._periods[5]+'m'+d+c._periods[6]+'s');this._addTarget(a)}c._hold=b;c._savePeriods=(b=='pause'?c._periods:null);$.data(a,this.propertyName,c);this._updateCountdown(a,c)}},_getTimesPlugin:function(a){var b=$.data(a,this.propertyName);return(!b?null:(b._hold=='pause'?b._savePeriods:(!b._hold?b._periods:this._calculatePeriods(b,b._show,b.options.significant,new Date()))))},_determineTime:function(k,l){var m=function(a){var b=new Date();b.setTime(b.getTime()+a*1000);return b};var n=function(a){a=a.toLowerCase();var b=new Date();var c=b.getFullYear();var d=b.getMonth();var e=b.getDate();var f=b.getHours();var g=b.getMinutes();var h=b.getSeconds();var i=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g;var j=i.exec(a);while(j){switch(j[2]||'s'){case's':h+=parseInt(j[1],10);break;case'm':g+=parseInt(j[1],10);break;case'h':f+=parseInt(j[1],10);break;case'd':e+=parseInt(j[1],10);break;case'w':e+=parseInt(j[1],10)*7;break;case'o':d+=parseInt(j[1],10);e=Math.min(e,x._getDaysInMonth(c,d));break;case'y':c+=parseInt(j[1],10);e=Math.min(e,x._getDaysInMonth(c,d));break}j=i.exec(a)}return new Date(c,d,e,f,g,h,0)};var o=(k==null?l:(typeof k=='string'?n(k):(typeof k=='number'?m(k):k)));if(o)o.setMilliseconds(0);return o},_getDaysInMonth:function(a,b){return 32-new Date(a,b,32).getDate()},_normalLabels:function(a){return a},_generateHTML:function(c){var d=this;c._periods=(c._hold?c._periods:this._calculatePeriods(c,c._show,c.options.significant,new Date()));var e=false;var f=0;var g=c.options.significant;var h=$.extend({},c._show);for(var i=Y;i<=S;i++){e|=(c._show[i]=='?'&&c._periods[i]>0);h[i]=(c._show[i]=='?'&&!e?null:c._show[i]);f+=(h[i]?1:0);g-=(c._periods[i]>0?1:0)}var j=[false,false,false,false,false,false,false];for(var i=S;i>=Y;i--){if(c._show[i]){if(c._periods[i]){j[i]=true}else{j[i]=g>0;g--}}}var k=(c.options.compact?c.options.compactLabels:c.options.labels);var l=c.options.whichLabels||this._normalLabels;var m=function(a){var b=c.options['compactLabels'+l(c._periods[a])];return(h[a]?d._translateDigits(c,c._periods[a])+(b?b[a]:k[a])+' ':'')};var n=function(a){var b=c.options['labels'+l(c._periods[a])];return((!c.options.significant&&h[a])||(c.options.significant&&j[a])?'<span class="'+x._sectionClass+'">'+'<span class="'+x._amountClass+'">'+d._translateDigits(c,c._periods[a])+'</span><br/>'+(b?b[a]:k[a])+'</span>':'')};return(c.options.layout?this._buildLayout(c,h,c.options.layout,c.options.compact,c.options.significant,j):((c.options.compact?'<span class="'+this._rowClass+' '+this._amountClass+(c._hold?' '+this._holdingClass:'')+'">'+m(Y)+m(O)+m(W)+m(D)+(h[H]?this._minDigits(c,c._periods[H],2):'')+(h[M]?(h[H]?c.options.timeSeparator:'')+this._minDigits(c,c._periods[M],2):'')+(h[S]?(h[H]||h[M]?c.options.timeSeparator:'')+this._minDigits(c,c._periods[S],2):''):'<span class="'+this._rowClass+' '+this._showClass+(c.options.significant||f)+(c._hold?' '+this._holdingClass:'')+'">'+n(Y)+n(O)+n(W)+n(D)+n(H)+n(M)+n(S))+'</span>'+(c.options.description?'<span class="'+this._rowClass+' '+this._descrClass+'">'+c.options.description+'</span>':'')))},_buildLayout:function(c,d,e,f,g,h){var j=c.options[f?'compactLabels':'labels'];var k=c.options.whichLabels||this._normalLabels;var l=function(a){return(c.options[(f?'compactLabels':'labels')+k(c._periods[a])]||j)[a]};var m=function(a,b){return c.options.digits[Math.floor(a/b)%10]};var o={desc:c.options.description,sep:c.options.timeSeparator,yl:l(Y),yn:this._minDigits(c,c._periods[Y],1),ynn:this._minDigits(c,c._periods[Y],2),ynnn:this._minDigits(c,c._periods[Y],3),y1:m(c._periods[Y],1),y10:m(c._periods[Y],10),y100:m(c._periods[Y],100),y1000:m(c._periods[Y],1000),ol:l(O),on:this._minDigits(c,c._periods[O],1),onn:this._minDigits(c,c._periods[O],2),onnn:this._minDigits(c,c._periods[O],3),o1:m(c._periods[O],1),o10:m(c._periods[O],10),o100:m(c._periods[O],100),o1000:m(c._periods[O],1000),wl:l(W),wn:this._minDigits(c,c._periods[W],1),wnn:this._minDigits(c,c._periods[W],2),wnnn:this._minDigits(c,c._periods[W],3),w1:m(c._periods[W],1),w10:m(c._periods[W],10),w100:m(c._periods[W],100),w1000:m(c._periods[W],1000),dl:l(D),dn:this._minDigits(c,c._periods[D],1),dnn:this._minDigits(c,c._periods[D],2),dnnn:this._minDigits(c,c._periods[D],3),d1:m(c._periods[D],1),d10:m(c._periods[D],10),d100:m(c._periods[D],100),d1000:m(c._periods[D],1000),hl:l(H),hn:this._minDigits(c,c._periods[H],1),hnn:this._minDigits(c,c._periods[H],2),hnnn:this._minDigits(c,c._periods[H],3),h1:m(c._periods[H],1),h10:m(c._periods[H],10),h100:m(c._periods[H],100),h1000:m(c._periods[H],1000),ml:l(M),mn:this._minDigits(c,c._periods[M],1),mnn:this._minDigits(c,c._periods[M],2),mnnn:this._minDigits(c,c._periods[M],3),m1:m(c._periods[M],1),m10:m(c._periods[M],10),m100:m(c._periods[M],100),m1000:m(c._periods[M],1000),sl:l(S),sn:this._minDigits(c,c._periods[S],1),snn:this._minDigits(c,c._periods[S],2),snnn:this._minDigits(c,c._periods[S],3),s1:m(c._periods[S],1),s10:m(c._periods[S],10),s100:m(c._periods[S],100),s1000:m(c._periods[S],1000)};var p=e;for(var i=Y;i<=S;i++){var q='yowdhms'.charAt(i);var r=new RegExp('\\{'+q+'<\\}([\\s\\S]*)\\{'+q+'>\\}','g');p=p.replace(r,((!g&&d[i])||(g&&h[i])?'$1':''))}$.each(o,function(n,v){var a=new RegExp('\\{'+n+'\\}','g');p=p.replace(a,v)});return p},_minDigits:function(a,b,c){b=''+b;if(b.length>=c){return this._translateDigits(a,b)}b='0000000000'+b;return this._translateDigits(a,b.substr(b.length-c))},_translateDigits:function(b,c){return(''+c).replace(/[0-9]/g,function(a){return b.options.digits[a]})},_determineShow:function(a){var b=a.options.format;var c=[];c[Y]=(b.match('y')?'?':(b.match('Y')?'!':null));c[O]=(b.match('o')?'?':(b.match('O')?'!':null));c[W]=(b.match('w')?'?':(b.match('W')?'!':null));c[D]=(b.match('d')?'?':(b.match('D')?'!':null));c[H]=(b.match('h')?'?':(b.match('H')?'!':null));c[M]=(b.match('m')?'?':(b.match('M')?'!':null));c[S]=(b.match('s')?'?':(b.match('S')?'!':null));return c},_calculatePeriods:function(c,d,e,f){c._now=f;c._now.setMilliseconds(0);var g=new Date(c._now.getTime());if(c._since){if(f.getTime()<c._since.getTime()){c._now=f=g}else{f=c._since}}else{g.setTime(c._until.getTime());if(f.getTime()>c._until.getTime()){c._now=f=g}}var h=[0,0,0,0,0,0,0];if(d[Y]||d[O]){var i=x._getDaysInMonth(f.getFullYear(),f.getMonth());var j=x._getDaysInMonth(g.getFullYear(),g.getMonth());var k=(g.getDate()==f.getDate()||(g.getDate()>=Math.min(i,j)&&f.getDate()>=Math.min(i,j)));var l=function(a){return(a.getHours()*60+a.getMinutes())*60+a.getSeconds()};var m=Math.max(0,(g.getFullYear()-f.getFullYear())*12+g.getMonth()-f.getMonth()+((g.getDate()<f.getDate()&&!k)||(k&&l(g)<l(f))?-1:0));h[Y]=(d[Y]?Math.floor(m/12):0);h[O]=(d[O]?m-h[Y]*12:0);f=new Date(f.getTime());var n=(f.getDate()==i);var o=x._getDaysInMonth(f.getFullYear()+h[Y],f.getMonth()+h[O]);if(f.getDate()>o){f.setDate(o)}f.setFullYear(f.getFullYear()+h[Y]);f.setMonth(f.getMonth()+h[O]);if(n){f.setDate(o)}}var p=Math.floor((g.getTime()-f.getTime())/1000);var q=function(a,b){h[a]=(d[a]?Math.floor(p/b):0);p-=h[a]*b};q(W,604800);q(D,86400);q(H,3600);q(M,60);q(S,1);if(p>0&&!c._since){var r=[1,12,4.3482,7,24,60,60];var s=S;var t=1;for(var u=S;u>=Y;u--){if(d[u]){if(h[s]>=t){h[s]=0;p=1}if(p>0){h[u]++;p=0;s=u;t=1}}t*=r[u]}}if(e){for(var u=Y;u<=S;u++){if(e&&h[u]){e--}else if(!e){h[u]=0}}}return h}});var w=['getTimes'];function isNotChained(a,b){if(a=='option'&&(b.length==0||(b.length==1&&typeof b[0]=='string'))){return true}return $.inArray(a,w)>-1}$.fn.countdown=function(a){var b=Array.prototype.slice.call(arguments,1);if(isNotChained(a,b)){return x['_'+a+'Plugin'].apply(x,[this[0]].concat(b))}return this.each(function(){if(typeof a=='string'){if(!x['_'+a+'Plugin']){throw'Unknown command: '+a;}x['_'+a+'Plugin'].apply(x,[this].concat(b))}else{x._attachPlugin(this,a||{})}})};var x=$.countdown=new Countdown()})(jQuery);
;(function($){$.countdown.regional['zh-CN']={labels:['年','月','周','天','时','分','秒'],labels1:['年','月','周','天','时','分','秒'],compactLabels:['年','月','周','天'],compactLabels1:['年','月','周','天'],whichLabels:null,digits:['0','1','2','3','4','5','6','7','8','9'],timeSeparator:':',isRTL:false};$.countdown.setDefaults($.countdown.regional['zh-CN']);})(jQuery);;;(function($)
{var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var delayTime=300;var animateTime=500;var animateTimeTwo=1000;var easing="easeOutBack";var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function(url)
{Fanli.Utility.requirejs(['overlay','expose','easing','light','switchable'],showPop);function showPop()
{$.light({popWidth:540,step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function()
{var $spotlight=$('#J-lrfl-spotlight');var $panelsOneTip=$("#J-lrfl-panles-shopping").find(".J-lrfl-panles-title");var $panelsTwoTip=$("#J-lrfl-panles-economize").find(".J-lrfl-panles-title");var $panelsThreeTip=$("#J-lrfl-panles-fanli").find(".J-lrfl-panles-title");$spotlight.switchable({putTriggers:'appendTo',panels:'.J-lrfl-panles',effect:'scrollLeft',prev:'#J-lrfl-panles-prev',next:'#J-lrfl-panles-next',triggersWrapCls:null,autoplay:true});}});}}
if(showsignupArr&&passCookieCondition){var url="";if(showsignupArr[1]=="1"){url="inviteRegisterForLanding";}else if(showsignupArr[1]=="4"){url="inviteRegisterForLanding3";}
url&&showSignupPop(url);}})(jQuery);(function($)
{var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPopBottom=function()
{Fanli.Utility.requirejs(['overlay','expose','easing'],showPop);function showPop()
{$.ajax({url:'//passport{0}/light/user/lightinviteregister'.format(Fanli.Utility.rootDomain),data:{'type':'lightinviteregisterforlandingbtm','go_url':window.location.href},type:"POST",dataType:"jsonp",jsonp:"jsoncallback",cache:true,scriptCharset:"utf-8",success:function(result)
{if(result.status="1")
{var $btmbar=$(result.data);$btmbar.appendTo('body');$btmbar.css('width',$(window).width());$btmbar.sidebar({min:0,fadeSpeed:200,position:'bottom',anchorOffset:0,relative:false,relativeWidth:990});}}});};}
if(showsignupArr&&showsignupArr[1]=="2"&&passCookieCondition){showSignupPopBottom();}})(jQuery);(function($)
{var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function()
{Fanli.Utility.requirejs(['overlay','expose','easing','light','switchable'],showPop);function showPop()
{$.light({popWidth:712,step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function()
{var $lightpopup=$('#lightpopup');$lightpopup.css('background','none');$('#J-three-login-close').click(function()
{$lightpopup.data('overlay').close();});}});}}
if(showsignupArr&&passCookieCondition){var url="";if(showsignupArr[1]=="3"){url="inviteRegisterForLanding2";}else if(showsignupArr[1]=="10"){url="inviteRegisterForLanding10";}else if(showsignupArr[1]=="11"){url="inviteRegisterForLanding11";}else if(showsignupArr[1]=="12"){url="inviteRegisterForLanding12";}
url&&showSignupPop(url);}})(jQuery);(function($)
{var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop2=function()
{Fanli.Utility.requirejs(['overlay','expose','easing','light','switchable'],showPop);function showPop()
{$.light({popWidth:712,step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function()
{var $lightpopup=$('#lightpopup');var $exposeMask=$('#exposeMask');$lightpopup.css('background','none');$('#J-three-login-close').click(function()
{var $this=$(this);if($this.data('state')=="1")
{$lightpopup.hide();$exposeMask.hide();$this.data('state','2');setTimeout(function()
{$lightpopup.show();$exposeMask.show();},3000);}
else
{$lightpopup.data('overlay').close();}});}});}}
if(showsignupArr&&showsignupArr[1]=="5"&&passCookieCondition)
{var url='inviteRegisterForLanding4';showSignupPop2(url);}})(jQuery);(function($)
{var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function()
{Fanli.Utility.requirejs(['overlay','expose','easing','light'],showPop);function showPop()
{$.light({popWidth:909,popTop:'center',step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function()
{$('#lightpopup').css({'background':'none','margin-top':'-455px'});}});}}
if(showsignupArr&&showsignupArr[1]=="6"&&passCookieCondition)
{var url='inviteRegisterForLanding6';showSignupPop(url);}})(jQuery);(function($){var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function(){Fanli.Utility.requirejs(['overlay','expose','easing','light'],showPop);function showPop(){$.light({popWidth:712,step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function(){$('#lightpopup').css('background','none');}});}}
if(showsignupArr&&passCookieCondition){var url="";if(showsignupArr[1]=="13"){url="inviteRegisterForLanding13";}else if(showsignupArr[1]=="14"){url="inviteRegisterForLanding14";}else if(showsignupArr[1]=="15"){url="inviteRegisterForLanding15";}
url&&showSignupPop(url);}})(jQuery);(function($){var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function(url){Fanli.Utility.requirejs(['overlay','expose','easing','light','switchable'],showPop);function showPop(){$.light({popWidth:712,step:url,postData:{'go_url':window.location.href},onSubmitSuccess:function(){var $spotlight=$('.J-panle-box');$('#lightpopup').css('background','none');$spotlight.switchable({triggers:false,putTriggers:'appendTo',panels:'.J-panle',effect:'scrollLeft',prev:'#J-arrow-prev',next:'#J-arrow-next',triggersWrapCls:null,autoplay:true});}});}}
if(showsignupArr&&showsignupArr[1]=="16"&&passCookieCondition){var url='inviteRegisterForLanding16';showSignupPop(url);}})(jQuery);(function($){var currentSearch=location.search;var showsignupArr=/showsignup=([^&]*)/gi.exec(currentSearch);var markcodeCookie="markcode".getCookie();var passCookieCondition=!!(markcodeCookie&&!(/^0\./g.test(markcodeCookie)))&&!("prouserid".getCookie());var showSignupPop=function(url,showsignup){Fanli.Utility.requirejs(['overlay','expose','light'],showPop);function showPop(){$.light({popWidth:730,step:url,postData:{'go_url':window.location.href,'showsignup':showsignup}});}}
if(showsignupArr&&showsignupArr[1]>17&&passCookieCondition){var url='inviteRegisterForLanding17';showSignupPop(url,showsignupArr[1]);}})(jQuery);;(function($)
{var defaults={text:"&times;",id:"J_cleanup",offset:{left:15,top:5},afterBuild:$.noop,afterCleanup:$.noop};$.fn.inputCleanup=function(options)
{var settings=$.extend(true,{},defaults,options);var id=settings.id;return this.each(function()
{var $this=$(this);$this.on("focusin.IC keyup.IC",function()
{var ph=$this.attr("placeholder");var val=$.trim($this.val());if(val&&val!=ph)
{if($("#{0}".format(id)).length==0)
{$this.before("<a href='javascript:void(0);' class='J_c_spoof_f' style='position:absolute;color:#d9d9d9;font-size:16px;font-weight:bold;font-family:tahoma;' id='{0}'>{1}</a>".format(id,settings.text));$("#{0}".format(id)).hover(function(){$(this).css("color","#949494")},function(){$(this).css("color","#d9d9d9")});adjustPosition($this,$("#{0}".format(id)));settings.afterBuild($("#{0}".format(id)));bindCleanup($this);}
else
{$("#{0}".format(id)).show();}}
else
{$("#{0}".format(id)).hide();}});});function adjustPosition($input,$cleanup)
{var $parent=$input.parent();$parent.css("position","relative");$cleanup.css({"left":$input.offset().left-$parent.offset().left+$input.outerWidth()-settings.offset.left+"px","top":settings.offset.top+"px"});}
function bindCleanup($input)
{$("#{0}".format(id)).on("click",function()
{$(this).hide();$input.val('').focus();;settings.afterCleanup.call($input);});}}
$.fn.inputCleanup.defaults=defaults;})(jQuery);;(function($){var $topbar=$('#topbar');window.prouserid='prouserid'.getCookie();window.prousername='prousernameutf'.getCookie(),window.lngmsgcnt='lngmsgcnt'.getCookie();window.topbarGetInfo=$.getJSON('//fun.fanli.com/topheader/ajaxGetInfoForTopbar?jsoncallback=?',function(json){var data=json.data;if(data.kefu){$topbar.data({'kfStatus':data.kefu.kf,'telStatus':data.kefu.tel});}
if(data.crm_mvp){$topbar.data({'hasCrmMvp':data.crm_mvp});}
if(data.timestamp){$topbar.data({'timestamp':data.timestamp});}
if(data.userinfo){$topbar.data({'bindEmail':data.userinfo.mail_validated,'lv':data.userinfo.lv||0});}}).done(topbarWrite);window.utmtOps=$.getJSON("//fun.fanli.com/topheader/ajaxGetMvpStorys?jsoncallback=?",function(res){var data=res.data;if(data.story_ids){$topbar.data({'betatest':data.story_ids});}});function topbarWrite(){var username=decodeURIComponent(decodeURIComponent(prousername));$quickinfo=$('#J_topbar_quick_info'),$chklogin=$('#J_topbar_chklogin'),$menucs=$('#J_topbar_cs_btn'),isShowMsg=$topbar.data("closemsg")!=1,lv=$topbar.data("lv");if(prouserid>0){var newS=new StringBuilder();newS.append('<div class="topbar-nav J-topbar-nav">').append('<div class="clearfix menu-hd menu-hd-name"><a class="l menu-name ellipsis" href="https://passport{1}/center/welcome" title={0}>{0}</a>'.format(username,Fanli.Utility.rootDomain));if(parseInt(lv)&&lv>0){newS.append('<a href="https://passport{2}/center/vip" class="l menu-lv"><img src="//static2.51fanli.net/common/images/level/icon-small-lv{0}.alpha.png" alt="等级{1}" width="16" height="16"></a>'.format(lv,lv,Fanli.Utility.rootDomain));}
newS.append('<i class="arrow"></i></div>').append('<div class="menu-bd menu-user">').append('<em class="arrow"></em>').append('<dl>').append('<dd><a href="https://passport{0}/center/orders">我的订单</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd><a href="https://passport{0}/center/deposit">我的返利</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd><a href="https://f{0}/life/mobiletopup/topup1">手机充值</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd><a href="https://passport{0}/center/safeuser/safecenter" rel="nofollow">账户设置</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd class="last"><a href="https://passport{0}/logout" rel="nofollow">退出</a></dd>'.format(Fanli.Utility.rootDomain)).append('</dl>').append('</div>').append('</div>').append('<div id="J_topbar_msg" class="topbar-msg clearfix"><a href="https://passport{0}/center/message"><i>消息</i><p class="msg-p"><span class="msg-span"><em>0</em></span></p></a></div>'.format(Fanli.Utility.rootDomain));$chklogin.html(newS.toString());if(GeneralValidation.isIe6()){var $username=$chklogin.find('.menuname');var csswidth=80;if($username.width()>csswidth){$username.width(csswidth);}};if(!lngmsgcnt)
{if(isShowMsg)
{$.getJSON('//passport{0}/client/user/getUserMessage?jsoncallback=?'.format(Fanli.Utility.rootDomain),function(data)
{if(data.status==1)
{lngmsgcnt=data.data;'lngmsgcnt'.setCookie(lngmsgcnt,'0.001',Fanli.Utility.rootDomain,'/');}
else
{lngmsgcnt=0;}
chkmsg(lngmsgcnt);});}
else
{$('#J_topbar_msg').find('.msg-span').remove();}}
else
{chkmsg(lngmsgcnt);}
var crmMvp=$topbar.data('hasCrmMvp')||'';if(crmMvp){var html='<div class="topbar-shopvip"><a href="'+crmMvp+'topbar" class="three">恭喜您获得8%的额外返利资格！</a><i></i></div>';$('#J_topbar_msg').append(html);}}
else{var url=encodeURIComponent(document.URL);var nwsb=new StringBuilder();nwsb.append('<div class="topbar-nav J-topbar-nav">').append('<div class="menu-hd"><a href="{0}/login?go_url={1}" rel="nofollow">马上登录</a><i class="arrow"></i></div>'.format(passportAppUrl,url)).append('<div class="menu-bd menu-login">').append('<em class="arrow"></em>').append('<dl>').append('<dd><a href="{0}/login?go_url={1}" rel="nofollow">返利登录</a></dd>'.format(passportAppUrl,url)).append('<dd><a href="https://passport{0}/oauth/jumpToUnion/type/qq/ab/1/cooklogin/1" rel="nofollow">QQ登录</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd><a href="https://passport{0}/oauth/jumpToUnion/type/sina/ab/1/cooklogin/1" rel="nofollow">新浪登录</a></dd>'.format(Fanli.Utility.rootDomain)).append('<dd><a href="https://passport{0}/oauth/jumpToUnion/type/wechat/ab/1/cooklogin/1" rel="nofollow">微信登录</a></dd>'.format(Fanli.Utility.rootDomain)).append('</dl>').append('</div>').append('</div>').append('<div class="topbar-reg"><a target="_blank" href="https://passport{1}/reg?action=yes&go_url={0}" rel="nofollow">免费注册</a></div>'.format(url,Fanli.Utility.rootDomain));$chklogin.html(nwsb.toString());}
$quickinfo.show();}
function chkmsg(lngmsgcnt){var $topUserMsg=$('#J_topbar_msg').find('a'),$userMsg=$('.usermsg'),html='',title='',klass='',len=lngmsgcnt.toString().length;if(lngmsgcnt==0){title='\u60a8\u6ca1\u6709\u65b0\u7684\u7ad9\u5185\u4fe1\uff01';$topUserMsg.attr('title',title).addClass('e0');$userMsg.closest('.usermsg-box').hide();}else{if(len==1){html='<em class="e2">'+lngmsgcnt+'</em>';klass='e2';}else if(len==2){html='<em class="e3">'+lngmsgcnt+'</em>';klass='e3';}else{html='<em class="e3">...</em>';klass='e3';}
title='\u60a8\u8fd8\u6709'+lngmsgcnt+'\u5c01\u65b0\u7684\u7ad9\u5185\u4fe1\u672a\u67e5\u770b\uff01';$topUserMsg.attr('title',title).find('span').prepend(html);setTimeout(function(){$topUserMsg.addClass(klass);$topUserMsg.find('span').animate({'margin-top':'0'},function(){$topUserMsg.find('em').eq(1).remove();});},500);$userMsg.text(lngmsgcnt).closest('.usermsg-box').show();}}})(jQuery);$(function(){var $topbar=$('#topbar');$topbar.on('mouseenter','.J-topbar-nav',function(){var $this=$(this);$this.addClass('topbar-nav-hover');menuImgLazy();}).on('mouseleave','.J-topbar-nav',function(){var $this=$(this);$this.removeClass('topbar-nav-hover');});$(document).on('click','.btn-cs',function(){open53kf();});$('div.message').on('click','.close',function(){$(this).parent().remove();});if($.fn.adloader&&$('#J-fa-topbar').length>0){$('#J-fa-topbar').adloader();}
else{$('#J-fa-topbar').remove();}
function menuImgLazy(){var $menuImgLazy=$('.J-menu-img-lazy');$menuImgLazy.each(function(){var $this=$(this);if($this.data('original')!=$this.attr('src')){$this.attr('src',$this.data('original'))}});}});(function(){"use strict";var $window=$(window);var contentUrl="//passport{0}/magicbar/user/customService?jsoncallback=?".format(Fanli.Utility.rootDomain);var jsUrl="//static2.51fanli.net/static/?f=common/js/module/magicbar/magicbarbase.js,common/js/module/magicbar/customservice.js";var v=parseInt(new Date().getTime()/300000);var csInstance;var triggerOffsetOriginal;var postData={};$(document).on("click",".J-mbar-mod-cs-show",function(ev){ev.preventDefault();var $this=$(this);triggerOffsetOriginal=$this.offset();postData.klass=$this.data("klass");if(csInstance){csInstance.trigger=$this;resetModPosition();csInstance.view.show();return;}else{buildDom($this);}}).on('click','.J-mbar-mod-cs-close',function()
{if(csInstance)
{csInstance.view.hide();}});function buildDom($trigger)
{$.getCacheJSONP(contentUrl,postData).done(function(res){if(!res.status){return;}
var $view=$(res.data).appendTo("body");setTimeout(function(){$.ajax({url:"{0}&v={1}".format(jsUrl,v),dataType:"script",cache:true}).done(function(){csInstance=new MagicBarCustomService();csInstance.view=$view;csInstance.trigger=$trigger;resetModPosition();csInstance.setup();csInstance.view.show();});},0);});}
function resetModPosition(){var viewWidth=350;var viewHeight=$('.J-mbar-msg-box-cs').height()||300;var $view=csInstance.view;var $trigger=csInstance.trigger;var triggerOffset=$trigger.offset().top?$trigger.offset():triggerOffsetOriginal;var triggerWidth=$trigger.outerWidth(true);var triggerHeight=$trigger.outerHeight(true);var winScrollTop=$(window).scrollTop();var winScrollLeft=$(window).scrollLeft();var targetLeft;var targetTop;var upDistance=triggerOffset.top-winScrollTop;var downDistance=winScrollTop+$(window).height()-triggerOffset.top-triggerHeight;var leftDistance=triggerOffset.left-winScrollLeft;var rightDistance=winScrollLeft+$(window).width()-triggerOffset.left-triggerWidth;targetTop=upDistance>downDistance?triggerOffset.top-viewHeight:triggerOffset.top+triggerHeight;targetLeft=leftDistance>rightDistance?triggerOffset.left-viewWidth:triggerOffset.left;$view.css({"left":targetLeft+"px",'top':targetTop+"px"});}}());utmtOps.done(function(){(function($){Fanli.ABTest=(function(){var separator="-";var $topbar=$("#topbar");var abTestCookieName="__utmt";var abTestCookieValue=abTestCookieName.getCookie();var abTestCookieValueArr=abTestCookieValue?abTestCookieValue.split(separator):[];var abTestTopbarValue=$topbar.data("betatest");var hasABTestTopbarValue=$topbar.length>0&&!!abTestTopbarValue;var abTestTopbarValueArr=hasABTestTopbarValue?abTestTopbarValue.split(separator):[];function _getMvpCookie(storyId){var returnValue="";var tryReg;if(!abTestCookieValue||!storyId){return returnValue;}
tryReg=abTestCookieValue.match(new RegExp(storyId+"[a-zA-Z]"));if(tryReg){returnValue=tryReg[0];}
return returnValue;}
function _clearMvpCookies(){if(hasABTestTopbarValue&&abTestTopbarValue=="deleteab"){abTestCookieName.setCookie("0",-1,Fanli.Utility.rootDomain,"/");return;}
var temObj={};var finalArr=[];if(abTestCookieValueArr.length==0||abTestTopbarValueArr.length==0){return;}
for(var i=0,len=abTestCookieValueArr.length;i<len;++i){var tem=abTestCookieValueArr[i];var tryReg=tem.match(/^(\d*)([a-zA-Z])$/);if(tryReg){temObj[tryReg[1]]=tem;}}
for(var j=0,jlen=abTestTopbarValueArr.length;j<jlen;++j){var temp=abTestTopbarValueArr[j];var tryItem=temObj[temp];if(tryItem){finalArr.push(tryItem);}}
abTestCookieName.setCookie(finalArr.join(separator),365,Fanli.Utility.rootDomain,"/");}
return{getMvpCookie:_getMvpCookie,clearMvpCookies:_clearMvpCookies}}());}(jQuery,FLNS.register("Fanli.ABTest")));Fanli.ABTest.clearMvpCookies();});(function()
{Fanli.Common.add("ServiceOnline",function()
{var $document=$(document);var triggerSelector=".J_show_customservice";var overlaySelector="#J_fanli_service_online_pop";var gotoTriggerSelector=".J_goto_trigger";var gotoPanelSelector=".J_goto_panel";var questionContSelect=".J_fanli_service_online_content";var endingContSelect=".J_fanli_service_online_ending";var ajaxUrl="//passport.fanli.com/magicbar/user/customService?jsoncallback=?";var kfUrl="https://webchat.fanli.com/WebChat/fanlionline.jsp?jid=61&sysNum=1476067342641247&device=pc&entry=pc&entry_name=pc%E5%AE%A2%E6%88%B7&custid="+prouserid;function setup()
{bindEvent();}
function bindEvent()
{$document.on("click",triggerSelector,function(ev)
{ev.preventDefault();window.open(kfUrl);}).on("click",gotoTriggerSelector,function()
{var $this=$(this);gotoPanel($this);}).on("click",".J_kf_trigger",function()
{open53kf();}).on("click",".J_goto_ending_trigger",function()
{showEnding();});}
function gotoPanel($trigger)
{$trigger.parents(gotoPanelSelector).fadeOut("fast",function()
{$(overlaySelector).find("{0}[data-number='{1}']".format(gotoPanelSelector,$trigger.attr("data-href"))).fadeIn("fast");});$(".J_kf_trigger").attr("id","ubt-kf-{0}".format($trigger.data("href")));}
function buildOverlay()
{if($(overlaySelector).length)
{showOverlay();}
else
{$.getCacheJSONP(ajaxUrl,function(JSON)
{if(JSON.status==1)
{$("body").append(JSON.data);Fanli.Utility.requirejs(['overlay','expose'],showOverlay);getKfStatus();}});}}
function getKfStatus()
{topbarGetInfo.done(function()
{var $topbar=$("#topbar");if($topbar.data('kfStatus'))
{$(overlaySelector).find(".J-kf-online").show();}
else
{$(overlaySelector).find(".J-kf-offline").show();}});}
function showOverlay()
{$(overlaySelector).data("overlay")?$(overlaySelector).data("overlay").load():bindOverlay();}
function bindOverlay()
{$(overlaySelector).overlay({top:"13%",mask:{color:"#000",opacity:0.5},fixed:false,onClose:function()
{$(overlaySelector).find(gotoPanelSelector).hide();$(overlaySelector).find("{0}[data-number='0']".format(gotoPanelSelector)).show();$(overlaySelector).find(questionContSelect).show();$(overlaySelector).find(endingContSelect).hide();}}).data('overlay').load();};function showEnding()
{$(overlaySelector).find(questionContSelect).fadeOut("fast",function()
{$(overlaySelector).find(endingContSelect).fadeIn("fast");});setTimeout(function()
{$(overlaySelector).data("overlay").close();},3000);}
setup();}).ServiceOnline();})(FLNS.register("Fanli.Common"));;(function($){$(function(){if((typeof _fanliBacktop!=='undefined')?_fanliBacktop:true){if($.fn.sidebar){$('#backtop').sidebar({min:60,relative:true,relativeWidth:980,backToTop:true,backContainer:'#btn-backtop'});}}
var $footerFa=$('#J-footer-fa');if('footerfa'.getCookie()!=1&&$footerFa.length>0&&$footerFa.css('visibility')!='hidden'&&$.fn.sidebar&&$.fn.adloader){var footerFaClose=true;$footerFa.css({'background':$footerFa.find('img').attr('alt')});if($.fn.sidebar){$footerFa.sidebar({min:0,relative:true,relativeWidth:-990});}
if(footerFaClose){$footerFa.append('<a href="javascript:void(0);" class="close">&times;</a>').on('click','.close',function(){$footerFa.remove();'footerfa'.setCookie('1','0.083',Fanli.Utility.rootDomain,'/');});}}
else{$footerFa.remove();}
function showWebNav(){var $trigger=$('.J_ft_showwebnav');var $panel=$('.J_ft_webnav');if($panel.find('a').length>0){$trigger.click(function()
{if($trigger.hasClass('expand')){$panel.hide();$trigger.removeClass('expand').find('.J_arr').html('&and;');}else{$panel.show();$trigger.addClass('expand').find('.J_arr').html('&or;');}});}
else{$trigger.remove();}}
showWebNav();});FLNS.register("Fanli.Public.Footer");Fanli.Public.Footer.add("InviteEnter",function()
{var $window=$(window);var $enterWrap=$("#J_fl_footer_invite_enter");var cookieName="FL_FOOTER_INVITE_ENTER";var isIE6=!!window.ActiveXObject&&!window.XMLHttpRequest;if($enterWrap.length)
{setup();}
function setup()
{bindLiveEvent();buildIe6Fix();}
function bindLiveEvent()
{if(cookieName.getCookie()!="1")
{$enterWrap.fadeIn("fast");}
$enterWrap.on("click",".J_close_btn",function()
{$enterWrap.fadeOut("fast");cookieName.setCookie("1",1,Fanli.Utility.rootDomain,"/");});}
function buildIe6Fix()
{if(isIE6)
{$enterWrap.css({'position':'absolute','top':$window.scrollTop()+$window.height()-$enterWrap.height()});$window.on('scroll.INVITE',function()
{$enterWrap.css({'position':'absolute','top':$window.scrollTop()+$window.height()-$enterWrap.height()});});}}}).InviteEnter();})(jQuery);;(function(){var $waterfall=$('#waterfall');var delayTimer=4000;function waterfall(){var $links=$waterfall.find('a');var $imgs=$waterfall.find('img');var pattern=/^#[0-9a-fA-F]{6}$/;if($links.length>1){var $large=$links.eq(0);var $small=$links.eq(1);var id=$large.data('id');var bgColor=$large.find('img').attr('alt');var cookie='ad_waterfall_'+id;$large.find('img').load(function(){$links.hide();if(pattern.test(bgColor)){$large.find('img').removeAttr('alt');$waterfall.css('background',bgColor);}
$waterfall.show();if(!cookie.getCookie()){$large.slideDown(500,function(){setTimeout(function(){$large.animate({'height':'80px'},500,function(){$small.show();$waterfall.height('80');$large.hide();});},delayTimer);});cookie.setCookie('1','1',Fanli.Utility.rootDomain,'/');}
else{$small.slideDown();}});}
else if($links.length>0){var bgColor=$waterfall.find('img').attr('alt');$waterfall.find('img').load(function(){if(pattern.test(bgColor)){$waterfall.find('img').removeAttr('alt');$waterfall.css('background',bgColor);}
$waterfall.slideDown();});}}
$waterfall.adloader({onReady:function(){waterfall();}});})();;var isHideFanliGroup=true;var hideFanliStr='<span class="hidefanliinfo" title="返利以实际到账为准"></span>';var hideNoFanliStr='<span class="hidenofanliinfo" ><span class="mid">无返利</span></span>'
var hideFanliShopStr='<span class="hidefanlishop">该店铺有返利</span>';function hideFanliSwitch(fanliinfo)
{return isHideFanliGroup?hideFanliStr:fanliinfo;}
function hideFanliShopSwitch(fanlishopinfo)
{return isHideFanliGroup?hideFanliShopStr:fanlishopinfo;};var _hmt=_hmt||[];function Ftrack(base){for(var i=1,length=arguments.length;i<length;i++){_hmt.push(['_trackEvent',base+'_'+arguments[i],'click','']);}
return false;}
(function(){var fanliId='545c20cb01a15219bfeb0d1f103f99c1';var budouId='8b40dd24ee21b28e2c2b108b4f804cb6';var _bdId=document.domain.indexOf('budou.com')>-1?budouId:fanliId;if(typeof(_baidu)!='undefined'){_bdId=_baidu;}
var hm=document.createElement("script");hm.src='//hm.baidu.com/hm.js?'+_bdId;var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();;(function(){"use strict";var mbContentUrl=passportAppUrl+"/magicbar/user/magicbar";var mbJs="//static2.51fanli.net/static/magicbar-js.js";var v=Fanli.Utility.staticTimeStamp();var isShow=$('#topbar').data('closemagicbar')!=1;if(isShow){$.getCacheJSONP("{0}?jsoncallback=?".format(mbContentUrl)).done(function(res){if(!res.status){return;}
var $view=$(res.data).appendTo("body");setTimeout(function(){$.ajax({url:"{0}?v={1}".format(mbJs,v),dataType:"script",cache:true}).done(function(){var mb=new MagicBar();mb.view=$view;mb.setup();});},0);});}}());
;(function () { var juicer = function () { var args = [].slice.call(arguments); args.push(juicer.options); if (args[0].match(/^\s*#([\w:\-\.]+)\s*$/igm)) { args[0].replace(/^\s*#([\w:\-\.]+)\s*$/igm, function ($, $id) { var _document = document; var elem = _document && _document.getElementById($id); args[0] = elem ? (elem.value || elem.innerHTML) : $ }) } if (juicer.documentHTML) { juicer.compile.call(juicer, juicer.documentHTML); juicer.documentHTML = '' } if (arguments.length == 1) { return juicer.compile.apply(juicer, args) } if (arguments.length >= 2) { return juicer.to_html.apply(juicer, args) } }; var __escapehtml = { escapehash: { '<': '&lt;', '>': '&gt;', '&': '&amp;', '"': '&quot;', "'": '&#x27;', '/': '&#x2f;' }, escapereplace: function (k) { return __escapehtml.escapehash[k] }, escaping: function (str) { return typeof (str) !== 'string' ? str : str.replace(/[&<>"']/igm, this.escapereplace) }, detection: function (data) { return typeof (data) === 'undefined' ? '' : data } }; var __throw = function (error) { if (typeof (console) !== 'undefined') { if (console.warn) { console.warn(error); return } if (console.log) { console.log(error); return } } throw (error); }; var __creator = function (o, proto) { o = o !== Object(o) ? {} : o; if (o.__proto__) { o.__proto__ = proto; return o } var empty = function () { }; var n = Object.create ? Object.create(proto) : new (empty.prototype = proto, empty); for (var i in o) { if (o.hasOwnProperty(i)) { n[i] = o[i] } } return n }; var annotate = function (fn) { var FN_ARGS = /^function\s*[^\(]*\(\s*([^\)]*)\)/m; var FN_ARG_SPLIT = /,/; var FN_ARG = /^\s*(_?)(\S+?)\1\s*$/; var FN_BODY = /^function[^{]+{([\s\S]*)}/m; var STRIP_COMMENTS = /((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg; var args = [], fnText, fnBody, argDecl; if (typeof fn === 'function') { if (fn.length) { fnText = fn.toString() } } else if (typeof fn === 'string') { fnText = fn } fnText = fnText.trim(); argDecl = fnText.match(FN_ARGS); fnBody = fnText.match(FN_BODY)[1].trim(); for (var i = 0; i < argDecl[1].split(FN_ARG_SPLIT).length; i++) { var arg = argDecl[1].split(FN_ARG_SPLIT)[i]; arg.replace(FN_ARG, function (all, underscore, name) { args.push(name) }) } return [args, fnBody] }; juicer.__cache = {}; juicer.version = '0.6.14'; juicer.settings = {}; juicer.documentHTML = ''; juicer.tags = { operationOpen: '{@', operationClose: '}', interpolateOpen: '\\${', interpolateClose: '}', noneencodeOpen: '\\$\\${', noneencodeClose: '}', commentOpen: '\\{#', commentClose: '\\}' }; juicer.options = { cache: true, strip: true, errorhandling: true, detection: true, _method: __creator({ __escapehtml: __escapehtml, __throw: __throw, __juicer: juicer }, {}) }; juicer.tagInit = function () { var forstart = juicer.tags.operationOpen + 'each\\s*([^}]*?)\\s*as\\s*(\\w*?)\\s*(,\\s*\\w*?)?' + juicer.tags.operationClose; var forend = juicer.tags.operationOpen + '\\/each' + juicer.tags.operationClose; var ifstart = juicer.tags.operationOpen + 'if\\s*([^}]*?)' + juicer.tags.operationClose; var ifend = juicer.tags.operationOpen + '\\/if' + juicer.tags.operationClose; var elsestart = juicer.tags.operationOpen + 'else' + juicer.tags.operationClose; var elseifstart = juicer.tags.operationOpen + 'else if\\s*([^}]*?)' + juicer.tags.operationClose; var interpolate = juicer.tags.interpolateOpen + '([\\s\\S]+?)' + juicer.tags.interpolateClose; var noneencode = juicer.tags.noneencodeOpen + '([\\s\\S]+?)' + juicer.tags.noneencodeClose; var inlinecomment = juicer.tags.commentOpen + '[^}]*?' + juicer.tags.commentClose; var rangestart = juicer.tags.operationOpen + 'each\\s*(\\w*?)\\s*in\\s*range\\(([^}]+?)\\s*,\\s*([^}]+?)\\)' + juicer.tags.operationClose; var include = juicer.tags.operationOpen + 'include\\s*([^}]*?)\\s*,\\s*([^}]*?)' + juicer.tags.operationClose; var helperRegisterStart = juicer.tags.operationOpen + 'helper\\s*([^}]*?)\\s*' + juicer.tags.operationClose; var helperRegisterBody = '([\\s\\S]*?)'; var helperRegisterEnd = juicer.tags.operationOpen + '\\/helper' + juicer.tags.operationClose; juicer.settings.forstart = new RegExp(forstart, 'igm'); juicer.settings.forend = new RegExp(forend, 'igm'); juicer.settings.ifstart = new RegExp(ifstart, 'igm'); juicer.settings.ifend = new RegExp(ifend, 'igm'); juicer.settings.elsestart = new RegExp(elsestart, 'igm'); juicer.settings.elseifstart = new RegExp(elseifstart, 'igm'); juicer.settings.interpolate = new RegExp(interpolate, 'igm'); juicer.settings.noneencode = new RegExp(noneencode, 'igm'); juicer.settings.inlinecomment = new RegExp(inlinecomment, 'igm'); juicer.settings.rangestart = new RegExp(rangestart, 'igm'); juicer.settings.include = new RegExp(include, 'igm'); juicer.settings.helperRegister = new RegExp(helperRegisterStart + helperRegisterBody + helperRegisterEnd, 'igm') }; juicer.tagInit(); juicer.set = function (conf, value) { var that = this; var escapePattern = function (v) { return v.replace(/[\$\(\)\[\]\+\^\{\}\?\*\|\.]/igm, function ($) { return '\\' + $ }) }; var set = function (conf, value) { var tag = conf.match(/^tag::(.*)$/i); if (tag) { that.tags[tag[1]] = escapePattern(value); that.tagInit(); return } that.options[conf] = value }; if (arguments.length === 2) { set(conf, value); return } if (conf === Object(conf)) { for (var i in conf) { if (conf.hasOwnProperty(i)) { set(i, conf[i]) } } } }; juicer.register = function (fname, fn) { var _method = this.options._method; if (_method.hasOwnProperty(fname)) { return false } return _method[fname] = fn }; juicer.unregister = function (fname) { var _method = this.options._method; if (_method.hasOwnProperty(fname)) { return delete _method[fname] } }; juicer.template = function (options) { var that = this; this.options = options; this.__interpolate = function (_name, _escape, options) { var _define = _name.split('|'), _fn = _define[0] || '', _cluster; if (_define.length > 1) { _name = _define.shift(); _cluster = _define.shift().split(','); _fn = '_method.' + _cluster.shift() + '.call({}, ' + [_name].concat(_cluster) + ')' } return '<%= ' + (_escape ? '_method.__escapehtml.escaping' : '') + '(' + (!options || options.detection !== false ? '_method.__escapehtml.detection' : '') + '(' + _fn + ')' + ')' + ' %>' }; this.__removeShell = function (tpl, options) { var _counter = 0; tpl = tpl.replace(juicer.settings.helperRegister, function ($, helperName, fnText) { var anno = annotate(fnText); var fnArgs = anno[0]; var fnBody = anno[1]; var fn = new Function(fnArgs.join(','), fnBody); juicer.register(helperName, fn); return $ }).replace(juicer.settings.forstart, function ($, _name, alias, key) { var alias = alias || 'value', key = key && key.substr(1); var _iterate = 'i' + _counter++; return '<% ~function() {' + 'for(var ' + _iterate + ' in ' + _name + ') {' + 'if(' + _name + '.hasOwnProperty(' + _iterate + ')) {' + 'var ' + alias + '=' + _name + '[' + _iterate + '];' + (key ? ('var ' + key + '=' + _iterate + ';') : '') + ' %>' }).replace(juicer.settings.forend, '<% }}}(); %>').replace(juicer.settings.ifstart, function ($, condition) { return '<% if(' + condition + ') { %>' }).replace(juicer.settings.ifend, '<% } %>').replace(juicer.settings.elsestart, function ($) { return '<% } else { %>' }).replace(juicer.settings.elseifstart, function ($, condition) { return '<% } else if(' + condition + ') { %>' }).replace(juicer.settings.noneencode, function ($, _name) { return that.__interpolate(_name, false, options) }).replace(juicer.settings.interpolate, function ($, _name) { return that.__interpolate(_name, true, options) }).replace(juicer.settings.inlinecomment, '').replace(juicer.settings.rangestart, function ($, _name, start, end) { var _iterate = 'j' + _counter++; return '<% ~function() {' + 'for(var ' + _iterate + '=' + start + ';' + _iterate + '<' + end + ';' + _iterate + '++) {{' + 'var ' + _name + '=' + _iterate + ';' + ' %>' }).replace(juicer.settings.include, function ($, tpl, data) { if (tpl.match(/^file\:\/\//igm)) return $; return '<%= _method.__juicer(' + tpl + ', ' + data + '); %>' }); if (!options || options.errorhandling !== false) { tpl = '<% try { %>' + tpl; tpl += '<% } catch(e) {_method.__throw("Juicer Render Exception: "+e.message);} %>' } return tpl }; this.__toNative = function (tpl, options) { return this.__convert(tpl, !options || options.strip) }; this.__lexicalAnalyze = function (tpl) { var buffer = []; var method = []; var prefix = ''; var reserved = ['if', 'each', '_', '_method', 'console', 'break', 'case', 'catch', 'continue', 'debugger', 'default', 'delete', 'do', 'finally', 'for', 'function', 'in', 'instanceof', 'new', 'return', 'switch', 'this', 'throw', 'try', 'typeof', 'var', 'void', 'while', 'with', 'null', 'typeof', 'class', 'enum', 'export', 'extends', 'import', 'super', 'implements', 'interface', 'let', 'package', 'private', 'protected', 'public', 'static', 'yield', 'const', 'arguments', 'true', 'false', 'undefined', 'NaN']; var indexOf = function (array, item) { if (Array.prototype.indexOf && array.indexOf === Array.prototype.indexOf) { return array.indexOf(item) } for (var i = 0; i < array.length; i++) { if (array[i] === item) return i } return -1 }; var variableAnalyze = function ($, statement) { statement = statement.match(/\w+/igm)[0]; if (indexOf(buffer, statement) === -1 && indexOf(reserved, statement) === -1 && indexOf(method, statement) === -1) { if (typeof (window) !== 'undefined' && typeof (window[statement]) === 'function' && window[statement].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i)) { return $ } if (typeof (global) !== 'undefined' && typeof (global[statement]) === 'function' && global[statement].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i)) { return $ } if (typeof (juicer.options._method[statement]) === 'function' || juicer.options._method.hasOwnProperty(statement)) { method.push(statement); return $ } if (statement.match(/^\d+/igm)) { return $ } buffer.push(statement) } return $ }; tpl.replace(juicer.settings.forstart, variableAnalyze).replace(juicer.settings.interpolate, variableAnalyze).replace(juicer.settings.ifstart, variableAnalyze).replace(juicer.settings.elseifstart, variableAnalyze).replace(juicer.settings.include, variableAnalyze).replace(/[\+\-\*\/%!\?\|\^&~<>=,\(\)\[\]]\s*([A-Za-z_0-9]+)/igm, variableAnalyze); for (var i = 0; i < buffer.length; i++) { prefix += 'var ' + buffer[i] + '=_.' + buffer[i] + ';' } for (var i = 0; i < method.length; i++) { prefix += 'var ' + method[i] + '=_method.' + method[i] + ';' } return '<% ' + prefix + ' %>' }; this.__convert = function (tpl, strip) { var buffer = [].join(''); buffer += "'use strict';"; buffer += "var _=_||{};"; buffer += "var _out='';_out+='"; if (strip !== false) { buffer += tpl.replace(/\\/g, "\\\\").replace(/[\r\t\n]/g, " ").replace(/'(?=[^%]*%>)/g, "\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g, "';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='") + "';return _out;"; return buffer } buffer += tpl.replace(/\\/g, "\\\\").replace(/[\r]/g, "\\r").replace(/[\t]/g, "\\t").replace(/[\n]/g, "\\n").replace(/'(?=[^%]*%>)/g, "\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g, "';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='") + "';return _out.replace(/[\\r\\n]\\s+[\\r\\n]/g, '\\r\\n');"; return buffer }; this.parse = function (tpl, options) { var _that = this; if (!options || options.loose !== false) { tpl = this.__lexicalAnalyze(tpl) + tpl } tpl = this.__removeShell(tpl, options); tpl = this.__toNative(tpl, options); this._render = new Function('_, _method', tpl); this.render = function (_, _method) { if (!_method || _method !== that.options._method) { _method = __creator(_method, that.options._method) } return _that._render.call(this, _, _method) }; return this } }; juicer.compile = function (tpl, options) { if (!options || options !== this.options) { options = __creator(options, this.options) } var that = this; var cacheStore = { get: function (tpl) { if (options.cachestore) { return options.cachestore.get(tpl) } return that.__cache[tpl] }, set: function (tpl, val) { if (options.cachestore) { return options.cachestore.set(tpl, val) } return that.__cache[tpl] = val } }; try { var engine = cacheStore.get(tpl) ? cacheStore.get(tpl) : new this.template(this.options).parse(tpl, options); if (!options || options.cache !== false) { cacheStore.set(tpl, engine) } return engine } catch (e) { __throw('Juicer Compile Exception: ' + e.message); return { render: function () { } } } }; juicer.to_html = function (tpl, data, options) { if (!options || options !== this.options) { options = __creator(options, this.options) } return this.compile(tpl, options).render(data, options._method) }; if (typeof (global) !== 'undefined' && typeof (window) === 'undefined') { juicer.set('cache', false) } if (typeof (document) !== 'undefined' && document.body) { juicer.documentHTML = document.body.innerHTML } typeof (module) !== 'undefined' && module.exports ? module.exports = juicer : this.juicer = juicer })();
;var ftrackv3pre="/virtual/taobao/new";var _tbTrackcode;if(typeof _trackcode!=='undefined'){_tbTrackcode=_trackcode;}else{_tbTrackcode='ar';};(function($)
{FLNS.register("Fanli.Taobao.Search");var FTS=Fanli.Taobao.Search;var $document=$(document);var titleTipsSelector="#J_tbsearch_title_tips";var $tbOverlay;var searchFlag=false;var $tbTipsPop=$('#popup-tb-tips');var isShowingDialog=false;FTS.add('initb',function()
{if($("#J_tbsearch_form").length==0){return;}
var $formProduct=$("#J_tbsearch_form"),$keywords=$('#J_tbsearch_keywords'),$realKeywordInput=$("#J_tbsearch_realkeywords"),$formBtn=$('#J_tbsearch_btn'),$errTip=$formProduct.find('.J_tbsearch_errtip'),$errTipText=$errTip.find('span');function searchInit(){$realKeywordInput.attr("name","keywords");$keywords.removeAttr("name");}
searchInit();bindSearchOverlay();var sErrNotlink='亲，淘宝/天猫升级为搜索宝贝标题拿返利喔！~请复制宝贝标题进行搜索。';var hasKeywords=/keywords\=/ig.test(window.location.href);function bindSearchOverlay(){if(!("header-tbs8pop".getCookie()>0)){$.getJSON("//fun.fanli.com/topheader/ajaxCheckHeaderPop?jsoncallback=?",function(res){if(res.status==1){$tbOverlay=$tbTipsPop.overlay({top:'20%',api:true,onLoad:function(){isShowingDialog=true;},onClose:function(){isShowingDialog=false;}});$('#btn-confirm-tb-tips').on("click",function(ev){ev.preventDefault();if($("#confirm-tb-nopop").prop("checked")){$.getJSON("//fun.fanli.com/topheader/ajaxSetHeaderPop?jsoncallback=?");}
searchFlag=true;$tbOverlay.close();$formProduct.submit();});$tbTipsPop.find('.close').click(function(ev){ev.preventDefault();searchFlag=true;$tbOverlay.close();$formProduct.submit();});}});}}
whiteEvent();if(hasKeywords){showErr(sErrNotlink);}
function whiteEvent(){var key;var submitHandle=function(){$formProduct.submit();};$formProduct.submit(function(ev){key=$.trim($keywords.val());if(key.length>6&&(/^http:\/\//i.test(key)||/^https:\/\//i.test(key)||/taobao\.com/i.test(key)||/tmall\.com/i.test(key))){showErr(sErrNotlink);return false;}
else{searchFunction();}
UBT.track("taobaofl_home","pc","pty-go11111~std-25999");if(!("header-tbs8pop".getCookie()>0)&&!searchFlag){$tbOverlay.load();return false;}
else{searchFlag=false;}});function searchFunction(){if(key==''){key=$keywords.attr('data-searchKey');}
$realKeywordInput.val(key);setTimeout(function(){if(!isShowingDialog){$keywords.val('');}
hideErr();},500);}
$keywords.on('keyup paste',function(){hideErr();var keyword=$.trim($keywords.val());if(keyword.length>6&&(/^http:\/\//i.test(keyword)||/^https:\/\//i.test(keyword)||/taobao\.com/i.test(keyword)||/tmall\.com/i.test(keyword))){showErr(sErrNotlink);}});$formBtn.on('click.submit',submitHandle);}
function showErr(txt){$errTipText.html(txt);$errTip.show();}
function hideErr(){$errTip.hide();$(titleTipsSelector).hide();}
$keywords.placeholder({type:'label',klass:'tb-search-placeholder',repair:true,color:'#d3d2d2',offset:[0,8]});$keywords.each(function(i){$(this).inputCleanup({id:"J_cleanup"+i,offset:{left:28,top:2},afterBuild:function($cleanup){$cleanup.removeAttr("style").wrap('<span class="srh-close"></span>')},afterCleanup:function(){hideErr();}});});$keywords.on('input.autocomplete',function(){$(this).trigger('keydown.autocomplete');}).autocomplete('https://suggest.taobao.com/sug?code=utf-8&area=b2c',{max:10,minChars:1,matchSubset:1,matchContains:1,cacheLength:0,scrollHeight:350,width:($keywords.width()+3),dataType:'jsonp',parse:function(json){var painVal=$.trim($keywords.val());if(/(taobao|tmall){1}\.com/ig.test(painVal)){$('.ac_results').hide();return[];}
if(!json.result)
return false;json=json.result;var data=new Array();$.each(json,function(i,n){data[i]={'name':n[0],'count':n[1]};});var parsed=[];for(var i=0;i<data.length;i++){parsed[parsed.length]={data:data[i],value:data[i].name,result:data[i].name};}
return parsed;},formatItem:function(item){return"<div><span style=\"float:left;\">"+item.name+"</span><span style=\"float:right;\">共找到宝贝数量"+item.count+"个</span></div>";},formatMatch:function(item){return item.name;},formatResult:function(item){return item.name;}});}).initb();})(jQuery);;(function($){var $rightFa=$('#J_taobao_right_fa');if($rightFa.length>0){$rightFa.sidebar({min:0,relative:true,relativeWidth:1020});}
(function(MODULE){MODULE.add("TimeStamp",function(options){var settings=$.extend(true,{callback:function(timestamp){}},options);$.getJSON('//fun{0}/topheader/getTime?jsoncallback=?'.format(Fanli.Utility.rootDomain),function(result){if(result.status==1){settings.callback(result.data.timestamp);}else{settings.callback(parseInt(new Date().getTime()/1000));}});});MODULE.add("ScrollLoad",function(options){var $window=$(window);var eventNamespace='.LOADMORECONTENT';var eventName="scroll{0} resize{0}".format(eventNamespace);if(typeof options=="string"&&options=="destroy"){$window.off(eventName);return;}
var settings=$.extend(true,{$wrap:$(document),cache:true,cacheTime:5,ajaxUrl:"",postData:{},threshold:$window.height()/2,container:window,autoRenderFirst:true,successCallback:$.noop,emptyCallback:$.noop,errorCallback:$.noop,ajaxTagSelector:".J_load_more_content_tag",ajaxLoadingSelector:".J_load_more_content_loading"},options);var isEnd=false,isSending=false,loadTime=1;var $wrap=settings.$wrap;var ajaxUrl=settings.ajaxUrl;var $ajaxTag=$wrap.find(settings.ajaxTagSelector);var $loading=$wrap.find(settings.ajaxLoadingSelector);function bindScrollEvent(){$window.on(eventName,function(){if(isEnd){breakScrollLoad();return;}
if(!isSending&&!$.belowthefold($ajaxTag,settings)){$loading.show();getContentAjax();}});}
function getContentAjax(){isSending=true;showLoadingBox();sendAjax();}
function sendAjax(){$.ajax({type:"GET",url:ajaxUrl,data:$.extend(true,{"page":loadTime},settings.postData),cache:true,dataType:"jsonp",jsonp:"jsoncallback",jsonpCallback:"jQuery83088605_"+parseInt(new Date().getTime()/(settings.cacheTime*60000)),success:function(result){if(result.status==1){isSending=false;settings.successCallback(result,loadTime);loadTime++;}else{breakScrollLoad();settings.errorCallback(result,loadTime);}}});}
function renderFirstCont(){if(settings.autoRenderFirst){loadTime=1;getContentAjax();}}
function showLoadingBox(){$loading.show();}
function hideLoadingBox(){$loading.hide();}
function breakScrollLoad(){$loading&&$loading.hide();isSending=false;$window.off(eventName);}
function setup(){renderFirstCont();bindScrollEvent();}
setup();});MODULE.add("AjaxList",function(){var $tab=$(".J_zdm_tab");var $tabNext=$(".J_zdm_tab_next");if($tab.length==0&&$tabNext.length==0){return;}
var $contentWrap=$("#J_content_wrap");var $loadInner=$contentWrap.find(".J_load_content_inner");var $window=$(window);var $tabNextDivs=$tabNext.find("div");var $empty=$(".J_loading_empty");function bindLazyload(){$("img.lazy").lazyload({threshold:$window.height()*3,effect:"show"});}
function initAjax(){$tabNext.on("click","a.J_zdm_tab_next_ys",function(){var $this=$(this);var cid=$this.data("id");var sid=$tab.find("a").eq(0).data("id");var ajaxUrl="//huodong.fanli.com/Hongbao20171111/getArtProducts?source=2&tab={0}&type={1}&from_sc=1&jsoncallback=?".format(sid,cid);var type=1;$this.addClass("current").siblings().removeClass("current");$loadInner.html("");MODULE.ScrollLoad("destroy");initChoiceness(ajaxUrl,type);});$tabNext.on("click","a.J_zdm_tab_next_zdm",function(){var $this=$(this);var cid=$this.data("id");var sid=$tab.find("a").eq(1).data("id")||2;var ajaxUrl="//huodong.fanli.com/Hongbao20171111/getArtProducts?source=2&tab={0}&type={1}&from_sc=1&jsoncallback=?".format(sid,cid);var type=2;$this.addClass("current").siblings().removeClass("current");$loadInner.html("");MODULE.ScrollLoad("destroy");initChoiceness(ajaxUrl,type);});$tab.on("click","a",function(){var $this=$(this);var index=$this.index();var $parent=$this.parent();var id=$this.data("id");$this.addClass("current").siblings().removeClass("current");$tabNextDivs.hide();if(id!=3){$tabNext.show();$tabNextDivs.eq(index).show();$tabNextDivs.eq(index).find("a").eq(0).trigger("click");}else{$tabNext.hide();$tabNextDivs.eq(0).find("a").eq(0).trigger("click");}});if($tab.length!=0){$tab.find("a.current").trigger("click");}else{$tabNextDivs.eq(1).show().find("a").eq(0).trigger("click");}}
function initChoiceness(ajaxUrl,type){bindScrollLoad({ajaxUrl:ajaxUrl,type:type});}
function bindScrollLoad(options){var settings=$.extend(true,{ajaxUrl:"",type:1},options);var ajaxUrl=settings.ajaxUrl;$(".J_loading_box").show();MODULE.ScrollLoad({ajaxUrl:ajaxUrl,successCallback:function(result,loadtimes){if(result.data.list&&result.data.list.length>0){$empty.hide();renderHtml(result,settings.type);if(result.data.list.length<8&&loadtimes==1){$(".J_loading_box").hide();MODULE.ScrollLoad("destroy");}}else{if(loadtimes==1){$empty.show();}
$(".J_loading_box").hide();MODULE.ScrollLoad("destroy");}}});}
function renderHtml(result,type){var data=result.data;if(type==1){var tpl=document.getElementById("J_item_tpl_ys").innerHTML;}else if(type==2){var tpl=document.getElementById("J_item_tpl_yg").innerHTML;}
var html=juicer(tpl,data);$loadInner.append(html);bindLazyload();setTimeout(function(){UBT.PlugIns.Exposure.init();bindCountdown();},200);}
function bindCountdown(){var $itemCount=$(".J_item_cd_time");if($itemCount.length!=0||$tab.length==0){MODULE.TimeStamp({callback:function(timestamp){var endtime=$itemCount.data("time");if(endtime>timestamp){$loadInner.addClass("no");$itemCount.countdown({until:Number(endtime)-timestamp,format:'HMS',layout:'<em>{hnn}</em>:<em>{mnn}</em>:<em>{snn}</em>',onExpiry:function(){$loadInner.removeClass("no").addClass("begin");}});}else{$loadInner.addClass("begin");}}});}}
function setup(){initAjax();}
setup();}).AjaxList();})(FLNS.register("Fanli.Shop.Hongbao20171111.Scroll"));})(jQuery);